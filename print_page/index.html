
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://mmondics.github.io/ocp-cloudpak-workshop/print_page/">
      
      <link rel="icon" href="../images/openshift-logo.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>Print Site - Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    
      


    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop" class="md-header__button md-logo" aria-label="Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop" data-md-component="logo">
      
  <img src="../images/openshift-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/mmondics/ocp-cloudpak-workshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop" class="md-nav__button md-logo" aria-label="Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop" data-md-component="logo">
      
  <img src="../images/openshift-logo.png" alt="logo">

    </a>
    Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mmondics/ocp-cloudpak-workshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../prerequisites/" class="md-nav__link">
        Prerequisites
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lab-assignments/" class="md-nav__link">
        Lab Assignments
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../workshop-architecture/" class="md-nav__link">
        Lab Architecture
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Labs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Labs" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Lab 003 - Using the z/OS Cloud Broker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab 003 - Using the z/OS Cloud Broker" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Lab 003 - Using the z/OS Cloud Broker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab003/lab003-1/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab003/lab003-2/" class="md-nav__link">
        Connect to OCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab003/lab003-3/" class="md-nav__link">
        Deploy Liberty for z/OS Using the z/OS Cloud Broker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab003/lab003-4/" class="md-nav__link">
        Stop and Restart Liberty for z/OS from OCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab003/lab003-5/" class="md-nav__link">
        Cleaning Up
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Lab 004 - Deploying an Application from Source Code
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab 004 - Deploying an Application from Source Code" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Lab 004 - Deploying an Application from Source Code
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab004/lab004-1/" class="md-nav__link">
        Source-to-Image (S2I) Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab004/lab004-2/" class="md-nav__link">
        Exploring GitHub and the Example Health Source Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab004/lab004-3/" class="md-nav__link">
        Connect to OCP and Authenticate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab004/lab004-4/" class="md-nav__link">
        Edit the Source Code and Push an Update
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab004/lab004-5/" class="md-nav__link">
        Cleaning Up
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          Lab 006 - Using Persistent Storage with MongoDB and NodeJS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab 006 - Using Persistent Storage with MongoDB and NodeJS" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Lab 006 - Using Persistent Storage with MongoDB and NodeJS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-1/" class="md-nav__link">
        Overview of Persistent Storage and Application Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-2/" class="md-nav__link">
        Connect to OCP and Authenticate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-3/" class="md-nav__link">
        Create a PersistentVolumeClaim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-4/" class="md-nav__link">
        Deploy MongoDB from Container Image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-5/" class="md-nav__link">
        Deploy Node.js Application from Dockerfile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-6/" class="md-nav__link">
        Interacting with MongoDB from Node.js Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab006/lab006-7/" class="md-nav__link">
        Cleaning Up
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_4">
          Lab 009 - OpenShift Pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab 009 - OpenShift Pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Lab 009 - OpenShift Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-1/" class="md-nav__link">
        Log into OpenShift Using the CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-2/" class="md-nav__link">
        Cloning the GitHub Repository and Viewing its Contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-3/" class="md-nav__link">
        Understanding and Deploying Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-4/" class="md-nav__link">
        Understanding and Deploying Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-5/" class="md-nav__link">
        Running the Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-6/" class="md-nav__link">
        Access the Application in a Browser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lab009/lab009-7/" class="md-nav__link">
        Cleaning Up
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Print Site
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Print Site
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-assignments" class="md-nav__link">
    Lab Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workshop-architecture" class="md-nav__link">
    Lab Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-labs" class="md-nav__link">
    Labs
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-assignments" class="md-nav__link">
    Lab Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workshop-architecture" class="md-nav__link">
    Lab Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-labs" class="md-nav__link">
    Labs
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-red-hat-openshift-and-ibm-cloud-paks-on-ibm-z-and-linuxone-workshop">Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE Workshop<a class="headerlink" href="#index-red-hat-openshift-and-ibm-cloud-paks-on-ibm-z-and-linuxone-workshop" title="Permanent link">&para;</a></h1>
<!--- 

Welcome to the Red Hat OpenShift and IBM Cloud Paks on IBM Z and LinuxONE workshop. Below you can find the workshop agenda, presentations, and lab documentation.

## Agenda

| Activity       | Duration     | 
| ---                  | ---           |
| **Presentation 1**              | 30-45 minutes   |
| Short Break   |        10-15 minutes      |
| **Presentation 2**           | ~ 1 hour      |
| Connect to environment as a group           | 10-15 minutes      |
| **Hands-on, self-paced labs**           | Remainder of day      |

!!! note
    The lab environments will be available the day following the workshop.

    For example, If the workshop is on a Thursday, the environments will be available until 5PM EST Friday.

### Presentations

* [Presentation 1 - High Level Overview of Red Hat OpenShift & IBM Cloud Paks on IBM Z](presentations/presentation1.pdf)
* [Presentation 2 - Technical Deep Dive, Installation & Configuration, Lessons Learned](presentations/presentation2.pdf)

!!! Note
    The labs are designed so that you can pick and choose which you would like to complete. The labs *are not* designed for you to get through them all in one day.

    Labs are non-sequential and have no dependencies on one another.

--->

<h2 id="index-techu-2021-labs">TechU 2021 Labs<a class="headerlink" href="#index-techu-2021-labs" title="Permanent link">&para;</a></h2>
<h3 id="index-introduction-to-openshift-on-ibm-z">Introduction to OpenShift on IBM Z<a class="headerlink" href="#index-introduction-to-openshift-on-ibm-z" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="#lab003-lab003-1">Lab 003 - Using the z/OS Cloud Broker</a></li>
<li><a href="#lab004-lab004-1">Lab 004 - Deploying an Application from Source Code</a></li>
</ul>
<h3 id="index-ops-with-openshift-on-ibm-z">Ops with OpenShift on IBM Z<a class="headerlink" href="#index-ops-with-openshift-on-ibm-z" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="#lab006-lab006-1">Lab 006 - Using Persistent Storage - MongoDB and NodeJS</a></li>
<li><a href="#lab009-lab009-1">Lab 009 - OpenShift Pipelines</a></li>
</ul>
<!---

* [Lab 001 - Exploring the OpenShift Console](lab001/lab001-1.md)
* [Lab 002 - Using the OpenShift Command Line (oc)](lab002/lab002-1.md)
* [Lab 003 - Using the z/OS Cloud Broker](lab003/lab003-1.md)
* [Lab 004 - Deploying an Application from Source Code](lab004/lab004-1.md)
* [Lab 005 - Monitoring, Metering, and Metrics](lab005/lab005-1.md)
* [Lab 006 - Using Persistent Storage - MongoDB and NodeJS](lab006/lab006-1.md)
* [Lab 007 - Deploying an Application with the Open Liberty Operator](lab007/lab007-1.md)
* [Lab 008 - Deploying an Application with Quarkus Red Hat Runtime](lab008/lab008-1.md)
* [Lab 009 - OpenShift Pipelines](lab009/lab009-1.md)
* [Lab 010 - OpenShift Service Mesh](lab010/lab010-1.md)

--->

<h2 id="index-workshop-environment-architecture">Workshop Environment Architecture<a class="headerlink" href="#index-workshop-environment-architecture" title="Permanent link">&para;</a></h2>
<p>Please visit <a href="#workshop-architecture">this page</a> to see the architecture of the workshop's lab environment.</p>
<h2 id="index-workshop-owners">Workshop Owners<a class="headerlink" href="#index-workshop-owners" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="mailto:matt.mondics@ibm.com">Matt Mondics</a></li>
<li><a href="mailto:pwnovak@us.ibm.com">Paul Novak</a></li>
</ul></section><section class="print-page" id="prerequisites"><h1 id="prerequisites-prerequisites">Prerequisites<a class="headerlink" href="#prerequisites-prerequisites" title="Permanent link">&para;</a></h1>
<h2 id="prerequisites-github-account">GitHub Account<a class="headerlink" href="#prerequisites-github-account" title="Permanent link">&para;</a></h2>
<p>If you wish to complete <a href="#lab004-lab004-1">Lab 004 - Deploying an Application from Source Code</a>, you must have your own GitHub account. You can create one create one by clicking the <em>Sign Up</em> button on the <a href="https://github.com/">GitHub homepage</a>.</p></section><section class="print-page" id="lab-assignments"><h1 id="lab-assignments-lab-assignments">Lab Assignments<a class="headerlink" href="#lab-assignments-lab-assignments" title="Permanent link">&para;</a></h1>
<p><strong>There are connection instructions below the table on this page.</strong></p>
<h2 id="lab-assignments-virtual-machine-openshift-logins">Virtual Machine &amp; OpenShift Logins<a class="headerlink" href="#lab-assignments-virtual-machine-openshift-logins" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Virtual Machine Password</th>
<th>User Number</th>
<th>OpenShift Username</th>
<th>OpenShift Password</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/5fc6d3b2e727e1012e4af599108a1fc5/desktops">feinberg</a></td>
<td><code>qbs94bmk</code></td>
<td>01</td>
<td>user01</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/2b990c41310a59c5e9bb242ff329c841/desktops">carlos</a></td>
<td><code>z5gknmic</code></td>
<td>02</td>
<td>user02</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/51d30678f242d33c0ab55a4f0c398935/desktops">dsotor</a></td>
<td><code>bniz788d</code></td>
<td>03</td>
<td>user03</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/b64c3912fef8a8fc315457ed59b84530/desktops">tamas.domjan</a></td>
<td><code>r36nr229</code></td>
<td>04</td>
<td>user04</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/2f8c48e7bab03863676711f5bc12fb9a/desktops">alessandro.roberto</a></td>
<td><code>tkawamvh</code></td>
<td>05</td>
<td>user05</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/79f35c7d1235928dcf490f1f2682f1d4/desktops">hansbuddenberg</a></td>
<td><code>uehuegf7</code></td>
<td>06</td>
<td>user06</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/50cd4983bf65e3e213df010f60b7e5a1/desktops">jimbo</a></td>
<td><code>boutod7l</code></td>
<td>07</td>
<td>user07</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/97fe2937a83374aa1993c9684aab1333/desktops">arkadiusz.kasprzyk</a></td>
<td><code>lqjvf948</code></td>
<td>08</td>
<td>user08</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/4f17ce67a941cf034a45ad0c3cc8ff24/desktops">peter.liszik</a></td>
<td><code>5j94k0iu</code></td>
<td>09</td>
<td>user09</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/61939e845b153ed9b636a5ac46b3f3b4/desktops">msalinasd</a></td>
<td><code>9p0cg5tj</code></td>
<td>10</td>
<td>user10</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/faa099af1476ac1f3d2f3a2eb1d84181/desktops">mduran</a></td>
<td><code>kd4ayvf7</code></td>
<td>11</td>
<td>user11</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/740c2f179d86c579e3a59d99f1217cbf/desktops">marcos.nogueira</a></td>
<td><code>kwz3dna8</code></td>
<td>12</td>
<td>user12</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/893a8debe4126f35534a14f494948209/desktops">racabral</a></td>
<td><code>bd7z4gta</code></td>
<td>13</td>
<td>user13</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/0ca009fd245f9e61e8d9b0beaf3d2893/desktops">jack.billings</a></td>
<td><code>02gmvqap</code></td>
<td>14</td>
<td>user14</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/99170853ba89a4c78f1e0aefdf70c64d/desktops">rwparece</a></td>
<td><code>21mqqwal</code></td>
<td>15</td>
<td>user15</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/8827875e4a75fa4c5c92f09c59daf380/desktops">TBD</a></td>
<td><code>h3wsxxjm</code></td>
<td>16</td>
<td>user16</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/6a398ad901d217beaf08c26234475b23/desktops">TBD</a></td>
<td><code>8p3tbbx9</code></td>
<td>17</td>
<td>user17</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/585ee557ecdcc246e00f857ec80d3108/desktops">TBD</a></td>
<td><code>4sr5g9ic</code></td>
<td>18</td>
<td>user18</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/ca95114e6dbfe3e169a76396117e9b0f/desktops">TBD</a></td>
<td><code>1dd62qd1</code></td>
<td>19</td>
<td>user19</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/3ff8d7c37d82eed880a6a48803d5daab/desktops">TBD</a></td>
<td><code>55riruoy</code></td>
<td>20</td>
<td>user20</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/5a6caf85774c12fa9e5ec97ac3089768/desktops">TBD</a></td>
<td><code>8gjadraj</code></td>
<td>21</td>
<td>user21</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/ca92d9b04cf3506cfdab530ee3cc5066/desktops">TBD</a></td>
<td><code>gdk97oqv</code></td>
<td>22</td>
<td>user22</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/d6ac7c7cd053b827b9537d43d24e2b22/desktops">TBD</a></td>
<td><code>mvhcn36k</code></td>
<td>23</td>
<td>user23</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/bd0735ba7ef62a14b80e3f9caee5ce44/desktops">TBD</a></td>
<td><code>fr1ypf3i</code></td>
<td>24</td>
<td>user24</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/0c2b5f2b854061096b3659b8981544ec/desktops">TBD</a></td>
<td><code>eihvmbbs</code></td>
<td>25</td>
<td>user25</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/d8aaa510a987b710aa6b2c94655711f4/desktops">TBD</a></td>
<td><code>lqn6nqgp</code></td>
<td>26</td>
<td>user26</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/1a7b69664a1ff0dfbdea26b59136d17c/desktops">TBD</a></td>
<td><code>i9uswpz9</code></td>
<td>27</td>
<td>user27</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/b57f5edfee98907722182c7f694c7827/desktops">TBD</a></td>
<td><code>kkav47jd</code></td>
<td>28</td>
<td>user28</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button" href="https://cloud.skytap.com/vms/3dcbdb9c2c883b7492fd8e4909ded882/desktops">TBD</a></td>
<td><code>nvz8supm</code></td>
<td>29</td>
<td>user29</td>
<td>p@ssw0rd</td>
</tr>
<tr>
<td><a class="md-button md-button--primary" href="https://cloud.skytap.com/vms/f39ebe5de1946045a83dae506fffde18/desktops">TBD</a></td>
<td><code>zzd2ngy9</code></td>
<td>30</td>
<td>user30</td>
<td>p@ssw0rd</td>
</tr>
</tbody>
</table>
<h2 id="lab-assignments-connecting-to-your-rhel-virtual-desktop">Connecting to your RHEL Virtual Desktop<a class="headerlink" href="#lab-assignments-connecting-to-your-rhel-virtual-desktop" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Click the link to your personal virtual machine</strong> and <strong>enter the Virtual Machine Password provided on the table</strong>.</p>
</li>
<li>
<p><strong>Click the box for the RHEL desktop</strong> that should be green and running.</p>
<p><img alt="rhel-running" src="../images/rhel-running.png" /></p>
</li>
<li>
<p><strong>Log into the RHEL desktop</strong> with the password: <code>p@ssw0rd</code>.</p>
<p><img alt="rhel-login" src="../images/rhel-login.png" /></p>
<div class="admonition note">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></p>
<p>Each virtual machine has a 3 hour inactivity timer. If you exceed this timeout, you can restart the virtual machine, but this will log you off of the VPN. If this happens, reach out to an instructor and they will log back into the VPN for you.</p>
</div>
</li>
</ol></section><section class="print-page" id="workshop-architecture"><h1 id="workshop-architecture-workshop-architecture-diagram">Workshop Architecture Diagram<a class="headerlink" href="#workshop-architecture-workshop-architecture-diagram" title="Permanent link">&para;</a></h1>
<p><img alt="workshop-arch" src="../ocpz-workshop-arch.drawio.svg" /></p>
<p>The OpenShift (OCP) on IBM Z environment used in this workshop is detailed in the diagram above.</p>
<p>Note that this <em>is not</em> the recommended OpenShift architecture for high availablity or production. For OCP on Z reference architectures <a href="https://www.ibm.com/docs/en/linux-on-systems?topic=openshift-reference-architecture">navigate to this link</a>.</p>
<p>The entire lab environment is behing the Washington Systems Center VPN. You are given a RHEL virtual machine with the Cisco AnyConnect VPN client installed and running which provides access to the WSC environment.</p>
<p>There are 3 OpenShift clusters you access during the labs. Because of the wide variety of lab material that requires different <a href="https://cloud.redhat.com/learn/topics/operators">operators</a>, each with their own resource and version requirements, it is simpler to divide labs on to multiple clusters.</p>
<p>Each OCP cluster is made up of 3 Control Planes and 3 Compute Nodes as shown in OCP Cluster 1 in the diagram. The Control Planes and Compute Nodes have a minimum of the resources shown for OCP cluster 1, although some clusters have more than the resources listed because of some more intensive applications running on them (IBM Cloud Paks &amp; Foundational Services).</p>
<p>All clusters are running on a single z/VM 7.1 instance on a single LPAR of an IBM z14 (again, not recommended outside of POC/demo).</p>
<p>There are various other support servers running as Linux guests that you use during these labs. These are outside of the OCP cluster itself, but take care of tasks such as LDAP, NFS storage, and a server with the <code>oc</code> command line <a href="https://docs.openshift.com/container-platform/4.8/cli_reference/openshift_cli/getting-started-cli.html">installed</a> that will let you connect to the three OpenShift clusters.</p></section>
                        <h1 class='nav-section-title' id='section-labs'>
                            Labs <a class='headerlink' href='#section-labs' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-lab-003-using-the-z-os-cloud-broker'>
                            Lab 003 - Using the z/OS Cloud Broker <a class='headerlink' href='#section-lab-003-using-the-z-os-cloud-broker' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="lab003-lab003-1"><h1 id="lab003-lab003-1-lab-003-the-zos-cloud-broker">Lab 003 - The z/OS Cloud Broker<a class="headerlink" href="#lab003-lab003-1-lab-003-the-zos-cloud-broker" title="Permanent link">&para;</a></h1>
<p>The <em>IBM z/OS Cloud Broker</em> is an offering that connects z/OS services running on an IBM Z backend to a frontend private cloud platform providing self-service access and consumption of these services to developers. This allows developers to provision their own z/OS resources directly from the OpenShift console – without the need for z/OS skills or direct access.</p>
<p><img alt="zoscb-arch.png" src="../images/zoscb-arch.png" /></p>
<p>The services available for the z/OS Cloud Broker to expose into OpenShift are:</p>
<table>
<thead>
<tr>
<th>z/OS Connect EE</th>
<th>Db2</th>
<th>CICS</th>
<th>IMS</th>
<th>MQ</th>
<th>WLP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Provision / deprovision z/OS Connect   Servers.     Start/Stop z/OS Connect Servers</td>
<td>Provision / deprovision Db2   subsystems, schemas, and databases +     snapshot / restore</td>
<td>Provision / deprovision CICS regions</td>
<td>Provision / deprovision IMS TM/DB   systems</td>
<td>Provision / deprovision MQ Queue   Manager subsystem</td>
<td>WebSphere Liberty Profile server provisioning, start/stop   server</td>
</tr>
</tbody>
</table>
<p>In this lab, you will be provisioning a WebSphere Liberty Profile (WLP) server on z/OS using the z/OS Cloud Broker on OpenShift. </p></section><section class="print-page" id="lab003-lab003-2"><h1 id="lab003-lab003-2-connect-to-openshift-and-authenticate">Connect to OpenShift and Authenticate<a class="headerlink" href="#lab003-lab003-2-connect-to-openshift-and-authenticate" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p>In your virtual machine desktop, <strong>open a Firefox web browser</strong>.</p>
</li>
<li>
<p>In the browser, <strong>navigate to the OpenShift on IBM Z console</strong> at the following address: <a href="https://console-openshift-console.apps.atsocpd1.dmz/">https://console-openshift-console.apps.atsocpd1.dmz/</a>.</p>
<div class="admonition important">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></p>
<p><strong><em>This is a different OpenShift cluster than the one used in other labs</em></strong>. Make sure you follow this correct link (atsocpd1) or you will not be able to find the z/OS Cloud Broker.</p>
</div>
<details class="note" open="open"><summary>Note</summary><p>You will receive a security challenge if the cluster has not yet been accessed from your browser. This is due to the default SSL certificate being “self-signed” and not yet recognized.</p>
<p>Accept the challenge to continue by <strong>clicking Advanced</strong> and then <strong>clicking Proceed to console-openshift-console.apps.atsocppa.dmz (unsafe)</strong>.</p>
<p>You will likely need to do this twice due to how OpenShift reroutes Oauth requests. </p>
</details>
<details><summary>Expand for screenshot</summary><p><img alt="security-accept.png" src="../images/security-accept.png" />
<img alt="security-accept-2.png" src="../images/security-accept-2.png" /></p>
</details>
<p>You will now see the OpenShift console login page.</p>
<p><img alt="openshift-console-login" src="../images/openshift-console-login.png" /></p>
</li>
<li>
<p><strong>Log in with the OpenShift credentials provided to you</strong> on the <a href="#lab-assignments">Lab Assignments</a> page.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Your OpenShift credentials will be something like the following:</p>
<ul>
<li>
<p>Username: userNN (where NN is your user number)</p>
</li>
<li>
<p>Password: p@ssw0rd</p>
</li>
</ul>
</div>
</li>
</ol></section><section class="print-page" id="lab003-lab003-3"><h1 id="lab003-lab003-3-deploy-liberty-for-zos-using-the-zos-cloud-broker">Deploy Liberty for z/OS Using the z/OS Cloud Broker<a class="headerlink" href="#lab003-lab003-3-deploy-liberty-for-zos-using-the-zos-cloud-broker" title="Permanent link">&para;</a></h1>
<p>With the z/OS Cloud Broker and OpenShift, provisioning z/OS resources is as easy as clicking on a tile in the OpenShift Developer Catalog.</p>
<ol>
<li>
<p><strong>Enter the Developer Perspective</strong>, if you aren’t there already.</p>
</li>
<li>
<p><strong>Make sure that you’re working under the z/OS Cloud Broker project <code>atg-zoscb</code></strong>.</p>
<div class="admonition important">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></p>
<p><strong><em>Unlike other labs, this lab uses a shared project for all lab attendees. Please pay close attention to naming conventions so you do not end up deleting other attendees’ provisioned services</em></strong>.</p>
</div>
<p><img alt="zoscb-project" src="../images/zoscb-project.png" /></p>
</li>
<li>
<p><strong>Click the +Add button in the left-side menu</strong>.</p>
</li>
<li>
<p><strong>Click the From Catalog tile</strong>.</p>
<p><img alt="from-catalog" src="../images/from-catalog.png" /></p>
</li>
<li>
<p><strong>Search the catalog for Liberty for z/OS</strong> and <strong>click on it</strong>.</p>
</li>
<li>
<p><strong>Click the Create button</strong> at the bottom of the page.</p>
<div class="admonition information">
<p class="admonition-title">Information</p>
<p>This Liberty service does not live inside this OpenShift cluster. It is, in fact, a template for a z/OS Liberty instance that z/OSMF has found and displayed. When you provision an instance, it will spin up the service in a completely different z/OS LPAR separate from the Linux LPAR where this OpenShift cluster is running.</p>
</div>
</li>
<li>
<p>All of the required fields will automatically populate for you, but <strong>rename the wlp service to <code>userNN-wlp</code></strong> where <code>NN</code> is your user number.</p>
<div class="admonition important">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></p>
<p>Please double check that you have correctly typed your user number for userNN. Remember that you are using a shared project for this lab, and nothing is stopping you from interfering with another lab participant's provisioned service if you use the wrong name.</p>
</div>
<p><img alt="create-wlp" src="../images/create-wlp.png" /></p>
</li>
<li>
<p><strong>Click the create button</strong>.</p>
<p>You will be brought to the <em>topology</em> page. After you click create, you will need to navigate to the <em>service instance</em> page:</p>
</li>
<li>
<p><strong>Switch to the Administrator Perspective -&gt; Operators in the menu bar -&gt; Installed Operators -&gt; Liberty for z/OS -&gt; Liberty for z/OS tab -&gt; Click on the instance with your user number NN</strong>.</p>
<p>You will end up on a screen that looks like the following:</p>
<p><img alt="wlp-deployed" src="../images/wlp-deployed.png" /></p>
<p>Notice two things:</p>
<ul>
<li>
<p>Depending on how quickly you navigated to this page and how long the WLP instance takes to provision, your status will be either <em>Pending</em> or <em>Succeeded</em>.</p>
</li>
<li>
<p>Once it’s <em>Succeeded</em>, you will have a link to your Dashboard.</p>
</li>
</ul>
<p>OpenShift is telling you that the service is either provisioned in z/OS, or in the process of being provisioned. While you don’t have access to z/OSMF, the following is what you would see over in the z/OSMF console:</p>
<p><img alt="wlp-zosmf" src="../images/wlp-zosmf.png" /></p>
<p>If you want to look at the z/OSMF console, ask an instructor and they will give you a tour.</p>
<p>This service will take a minute or two to provision. Wait until you see the following messages on the service instance page:</p>
<p><img alt="green-succeeded" src="../images/green-succeeded.png" /></p>
<p><img alt="provisioned-successfully" src="../images/provisioned-successfully.png" /></p>
<p>Over on z/OSMF page again, this is what one would see:</p>
<p><img alt="zosmf-success" src="../images/zosmf-success.png" /></p>
<p>And in z/OS itself, the following task is started:</p>
<p><img alt="zos-started" src="../images/zos-started.png" /></p>
<p>You have just successfully provisioned a Liberty instance on z/OS, without leaving the OpenShift console.</p>
</li>
<li>
<p>From the OpenShift WLP instance page, <strong>click the Dashboard URL hyperlink</strong>.</p>
</li>
<li>
<p><strong>Click the Log in with OpenShift button</strong>.</p>
</li>
<li>
<p>You might get a security challenge here. If you do, <strong>make sure that both of the two checkboxes are checked, and click Allow Selected Permissions</strong>.</p>
<p>You will be taken to the dashboard for your z/OS Liberty instance. This page will be referred to as the <em>Dashboard</em> tab.</p>
<p><img alt="dashboard-tab" src="../images/dashboard-tab.png" /></p>
<p>The right side of the page contains information about your WLP service and the z/OS system it’s running on.</p>
<p>The left side of the page contains buttons you can use to perform various actions. You will use a few of them shortly.</p>
</li>
<li>
<p><strong>Scroll to the bottom of the right-hand column, and locate the <code>IP_ADDRESS</code> variable</strong>.</p>
<details class="hint"><summary>Hint</summary><p>It's <code>192.168.176.154</code>. That’s the IP address of the z/OS system on which z/OSMF and Liberty for z/OS are hosted.</p>
</details>
</li>
<li>
<p><strong>Scroll up a bit and locate the <code>HTTP_PORT</code> variable</strong>. It’s just about in the middle of the column.</p>
<details class="hint"><summary>Hint</summary><p>It's something like <code>9XXX</code>, where <code>XXX</code> will be unique for each user.</p>
</details>
</li>
<li>
<p><strong>Keeping the Dashboard tab open, open a new browser tab</strong>.</p>
</li>
<li>
<p><strong>In the new tab, navigate to <code>&lt;IP_ADDRESS&gt;:&lt;HTTP_PORT&gt;</code></strong></p>
<details class="hint"><summary>Hint</summary><p>It will look something like <code>192.168.176.154:9XXX</code>, where the <code>XXX</code> is unique for each user.</p>
</details>
<p>You should see the default Liberty homepage. This is the Liberty service you just provisioned on z/OS.</p>
<p><img alt="liberty-homepage" src="../images/liberty-homepage.png" /></p>
</li>
<li>
<p>Staying in this “Welcome to Liberty” tab, <strong>add the following string to the end of the URL</strong>: <code>/CloudTestServlet</code></p>
</li>
<li>
<p><strong>Press enter</strong>.</p>
<p>That will take you to a sample application that was deployed into the Liberty z/OS instance you provisioned.  You will see something like this:</p>
<p><img alt="servlet" src="../images/servlet.png" /></p>
<p>Note the date and timestamp. It should be the current time (in U.S. Eastern time format).</p>
</li>
<li>
<p><strong>Reload the browser tab</strong>.  You should see the time-stamp change.</p>
<p><strong>Do not close this tab</strong>.</p>
</li>
<li>
<p><strong>Return to the Dashboard tab</strong>, which had all the information about the provisioned instance in it.</p>
</li>
</ol></section><section class="print-page" id="lab003-lab003-4"><h1 id="lab003-lab003-4-stop-and-restart-liberty-for-zos-from-ocp">Stop and Restart Liberty for z/OS from OCP<a class="headerlink" href="#lab003-lab003-4-stop-and-restart-liberty-for-zos-from-ocp" title="Permanent link">&para;</a></h1>
<p>In the <em>Dashboard</em> tab, you should see the following on the left side of the screen:</p>
<p><img alt="stop-wlp" src="../images/stop-wlp.png" /></p>
<ol>
<li>
<p><strong>Click the "Run" button that's associated with "Stop"</strong>.</p>
</li>
<li>
<p><strong>Click the “Action History” button above</strong>.</p>
<p>Depending how quickly you click on this button, you’ll see either:</p>
<p><img alt="stop-in-progress" src="../images/stop-in-progress.png" /></p>
<p>If the stop is in progress, or:</p>
<p><img alt="stop-complete" src="../images/stop-complete.png" /></p>
<p>if the stop completed before you looked at the Action History.</p>
<p>Over in z/OSMF, one would see:</p>
<p><img alt="zosmf-stopped" src="../images/zosmf-stopped.png" /></p>
</li>
<li>
<p>Once you see in the Action History that the stop has completed, <strong>go back to the tab where the timestamp application was</strong> (<code>192.168.176.154:9XXX</code>, if you accidentally closed it).</p>
</li>
<li>
<p><strong>Reload this page</strong>.</p>
<p>You will see the following:</p>
<p><img alt="wlp-stopped" src="../images/wlp-stopped.png" /></p>
</li>
<li>
<p><strong>Go back to the Dashboard tab and click the “Run” button that’s associated with “Start”</strong>.</p>
<p><img alt="start-wlp" src="../images/start-wlp.png" /></p>
<p>This will trigger a workflow over in z/OSMF to start the server.</p>
</li>
<li>
<p><strong>Click “Action History” and refresh until you see that the Start workflow is complete</strong>.</p>
<p><img alt="start-complete" src="../images/start-complete.png" /></p>
</li>
<li>
<p><strong>Go back to the tab with the timestamp application and reload the page</strong>.</p>
<p>You should see the time and date with the current time shown:</p>
<p><img alt="wlp-restarted" src="../images/wlp-restarted.png" /></p>
<p>This indicates that the server is back up and serving pages</p>
</li>
</ol></section><section class="print-page" id="lab003-lab003-5"><h1 id="lab003-lab003-5-cleaning-up">Cleaning Up<a class="headerlink" href="#lab003-lab003-5-cleaning-up" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p><strong>Close the tab with the timestamp application</strong>.</p>
</li>
<li>
<p><strong>Close the Dashboard tab</strong>.</p>
</li>
<li>
<p><strong>Navigate back to your userNN-wlp instance</strong></p>
<details class="hint" open="open"><summary>Hint</summary><p>Administrator -&gt; Operators -&gt; Installed Operators -&gt; Liberty for z/OS -&gt; Liberty for z/OS tab</p>
</details>
</li>
<li>
<p><strong>Click the three dots to the far right of your provisioned service and click Delete WLP</strong>.</p>
<p><img alt="delete-wlp" src="../images/delete-wlp.png" /></p>
<p>Over in z/OSMF, that will trigger a de-provision operation:</p>
<p><img alt="deprovision-wlp" src="../images/deprovision-wlp.png" /></p>
</li>
</ol>
<p>When the operation is complete, you will see</p>
<p><img alt="no-operands" src="../images/no-operands.png" /></p>
<p>On z/OSMF, the Liberty z/OS server instance has been de-provisioned, which means it was stopped and the file system location for the server instance removed.</p></section><h1 class='nav-section-title-end'>Ended: Lab 003 - Using the z/OS Cloud Broker</h1>
                        <h2 class='nav-section-title' id='section-lab-004-deploying-an-application-from-source-code'>
                            Lab 004 - Deploying an Application from Source Code <a class='headerlink' href='#section-lab-004-deploying-an-application-from-source-code' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="lab004-lab004-1"><h1 id="lab004-lab004-1-lab-004-deploying-an-application-from-source-code">Lab 004 - Deploying an Application from Source Code<a class="headerlink" href="#lab004-lab004-1-lab-004-deploying-an-application-from-source-code" title="Permanent link">&para;</a></h1>
<p>OpenShift is designed for users with various responsibilities, backgrounds and skillsets. Most broadly, OpenShift is designed for two main groups – <em>administrators</em> and <em>developers</em>. Furthermore, there are different types of administrators, and different types of developers.</p>
<p>As much of the Information Technology world moves toward cloud technology as the consumption model for enterprise computing, developers are required to make a shift in the tools they use to perform their work. At the heart of almost every cloud platform there are two of these new, core technologies – <em>containers</em> and <em>container orchestrators</em>.</p>
<details class="note" open="open"><summary>Note</summary><p>We won’t be specifically covering these technologies in this lab, but you’ve probably heard of them. Docker is the most popular container runtime, and Kubernetes is the most popular container orchestrator. For the curious, OpenShift replaced Docker containers with CRI-O containers when moving from v3.11 to v4.1 (although Docker containers will still work in OpenShift 4.x).</p>
</details>
<p>However, not every developer wants (or needs) to learn these new technologies in order to take advantage of them. In fact, OpenShift enables developers with no container experience at all to simply provide their source code (written in Javascript, Python, Go, etc.) and let OpenShift build the container for them using its <strong><em>Source-to-Image (S2I) capability</em></strong>.</p></section><section class="print-page" id="lab004-lab004-2"><h1 id="lab004-lab004-2-exploring-github-and-the-example-health-source-code">Exploring GitHub and the Example Health Source Code<a class="headerlink" href="#lab004-lab004-2-exploring-github-and-the-example-health-source-code" title="Permanent link">&para;</a></h1>
<p>In this lab, you will be deploying a sample healthcare application called <em>Example Health</em>. The application is written in JavaScript, and it’s loaded into IBM’s GitHub repository.</p>
<ol>
<li>
<p>In Firefox, <strong>navigate to <a href="https://github.com/IBM/node-s2i-openshift">https://github.com/IBM/node-s2i-openshift</a></strong></p>
<p><img alt="ibm-repo" src="../images/ibm-repo.png" /></p>
<p>This is an IBM repository that contains everything you need in order to deploy the application – including a <code>README.md</code> file with information and instructions, additional files required for the source code to work, and the source code itself. Let’s look at the source code now.</p>
</li>
<li>
<p><strong>Open the site folder</strong>.</p>
<p><img alt="site-dir" src="../images/site-dir.png" /></p>
</li>
<li>
<p><strong>Open the app.js file</strong>.</p>
<p><img alt="app-js" src="../images/app-js.png" /></p>
<p>This is the source code for the frontend application that OpenShift will build into a container. Notice that it is NOT any sort of container image, Dockerfile, or YAML file itself – rather, it is <em>written in Javascript</em>. Feel free to look through the code.</p>
</li>
<li>
<p><strong>Click on the node-s2i-openshift hyperlink</strong> to get back to the main repository page.</p>
<p>Your URL should again be <a href="https://github.com/IBM/node-s2i-openshift">https://github.com/IBM/node-s2i-openshift</a></p>
<p>You’ll need to make a fork of this repository so you have your own copy to work with. To do so, you’ll first need to sign into GitHub.</p>
</li>
<li>
<p><strong>Click the Sign In button in the top right</strong>.</p>
<p><img alt="gh-sign-in" src="../images/gh-sign-in.png" /></p>
</li>
<li>
<p><strong>Log in with YOUR OWN GitHub credentials</strong>.</p>
<details class="note" open="open"><summary>Note</summary><p>If you don’t have a GitHub account already, please create one and then sign in with it.</p>
</details>
<p>After a successful login, you will be taken back to the main repository page. Now you can create your own fork of the repository.</p>
</li>
<li>
<p><strong>Click the Fork button on the left side of the page</strong>.</p>
<p><img alt="gh-fork" src="../images/gh-fork.png" /></p>
<p>When complete, you will be taken to your forked repository page</p>
<p>Notice that while everything else looks basically  the same, the URL has changed from <a href="https://github.com/IBM/node-s2i-openshift">https://github.com/IBM/node-s2i-openshift</a></p>
<p>to:</p>
<p><a href="https://github.com/YOUR_GITHUB_USERNAME/node-s2i-openshift">https://github.com/YOUR_GITHUB_USERNAME/node-s2i-openshift</a></p>
</li>
<li>
<p><strong>Leave this browser tab open, and open another</strong>.</p>
</li>
</ol></section><section class="print-page" id="lab004-lab004-3"><h1 id="lab004-lab004-3-connect-to-ocp-and-authenticate">Connect to OCP and Authenticate<a class="headerlink" href="#lab004-lab004-3-connect-to-ocp-and-authenticate" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p>In your virtual machine desktop, <strong>open a Firefox web browser</strong>.</p>
</li>
<li>
<p>In the browser, <strong>navigate to the OpenShift on IBM Z console</strong> at the following address: <a href="https://console-openshift-console.apps.atsocppa.dmz/">https://console-openshift-console.apps.atsocppa.dmz/</a>.</p>
<details class="note" open="open"><summary>Note</summary><p>You will receive a security challenge if the cluster has not yet been accessed from your browser. This is due to the default SSL certificate being “self-signed” and not yet recognized.</p>
<p>Accept the challenge to continue by <strong>clicking Advanced</strong> and then <strong>clicking Proceed to console-openshift-console.apps.atsocppa.dmz (unsafe)</strong>.</p>
<p>You will likely need to do this twice due to how OpenShift reroutes Oauth requests. </p>
</details>
<details><summary>Expand for screenshot</summary><p><img alt="security-accept.png" src="../images/security-accept.png" />
<img alt="security-accept-2.png" src="../images/security-accept-2.png" /></p>
</details>
<p>You will now see the OpenShift console login page.</p>
<p><img alt="openshift-console-login" src="../images/openshift-console-login.png" /></p>
</li>
<li>
<p>Log in with the OpenShift credentials provided to you on the <a href="#lab-assignments">Lab Assignments</a> page.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Your OpenShift credentials will be something like the following:</p>
<ul>
<li>
<p>Username: userNN (where NN is your user number)</p>
</li>
<li>
<p>Password: p@ssw0rd</p>
</li>
</ul>
</div>
</li>
</ol></section><section class="print-page" id="lab004-lab004-4"><h1 id="lab004-lab004-4-edit-the-source-code-and-push-an-update">Edit the Source Code and Push an Update<a class="headerlink" href="#lab004-lab004-4-edit-the-source-code-and-push-an-update" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p><strong>Switch to the Developer Perspective</strong>, if not already on it.</p>
<p><img alt="developer-perspective" src="../images/developer-perspective.png" /></p>
</li>
<li>
<p><strong>Change into your userNN-project</strong> if not already in it.</p>
<p><img alt="userNN-project" src="../images/userNN-project.png" /></p>
</li>
<li>
<p><strong>Click the +Add button from the left-side menu</strong>.</p>
<p><img alt="add-workload" src="../images/add-workload.png" /></p>
</li>
<li>
<p><strong>Click the From Git tile</strong>.</p>
<p><img alt="from-git" src="../images/from-git.png" /></p>
</li>
<li>
<p><strong>In the Git Repo URL field, enter the URL of your forked repository</strong>.</p>
<p>It will look something like: <a href="https://github.com/YOUR_GITHUB_USERNAME/node-s2i-openshift">https://github.com/YOUR_GITHUB_USERNAME/node-s2i-openshift</a></p>
<p><img alt="import-from-git" src="../images/import-from-git.png" /></p>
</li>
<li>
<p><strong>Click the Show Advanced Git Options hyperlink</strong>.</p>
</li>
<li>
<p><strong>In the Context Dir field, enter <code>/site</code></strong>.</p>
<p><img alt="show-advanced" src="../images/show-advanced.png" /></p>
<details class="note" open="open"><summary>Recall</summary><p>This is the folder in the GitHub repository that you dug into to view the source code.</p>
</details>
</li>
<li>
<p><strong>For Builder Image, select the Node.js tile</strong>.</p>
<p><img alt="node-tile" src="../images/node-tile.png" /></p>
</li>
<li>
<p><strong>Scroll to the bottom of this page and click the Create button</strong>.</p>
<p>You will be taken to the Topology page, which will show your new application along with three smaller circular buttons that can be used to perform different actions against the application.</p>
</li>
<li>
<p><strong>Click the circular Node.js application icon</strong>.</p>
<p><img alt="node-icon" src="../images/node-icon.png" /></p>
<p>At first, the icon will be all white and you will see “Build #1 is running” in the righthand panel. If you wish, you can watch the logs for the running Build to see everything it’s doing. After a minute or two, the icon will have a green check mark next to it, indicating the Build is complete. Once the Build is complete, your Pod will be created. You can also watch the logs for this, if you wish. About 10 seconds later, a solid blue ring will appear around the edge of the circular icon, indicating that the pod is up and running.</p>
<p><img alt="node-panel" src="../images/node-panel.png" /></p>
<details class="note" open="open"><summary>Note</summary><p>Feel free to click on the <em>View Logs</em> hyperlink to watch everything that the build is creating. When complete, the log will display <code>Push Successful</code>, and you can return to the Topology page by clicking the link on the left side of the page.</p>
</details>
<p>If you clicked off of the Node.js application Resources tab, click on the circular icon again, then click on the Resources tab.</p>
</li>
<li>
<p><strong>Click the Route URL</strong> – beginning with http://</p>
<p><img alt="route-url" src="../images/route-url.png" /></p>
<p>You will be taken to the Example Health application.</p>
<p><img alt="example-health-login" src="../images/example-health-login.png" /></p>
</li>
<li>
<p><strong>Log into the Example Health application using the following credentials</strong>:</p>
<ul>
<li>Username: <code>test</code></li>
<li>Password: <code>test</code></li>
</ul>
<p><img alt="example-health-patient" src="../images/example-health-patient.png" /></p>
<p>All of the data in this application is simulated to look similar to the health records of an insurance company. Feel free to explore the application and notice the multiple tabs it contains.</p>
<p>The JavaScript code you looked at in your forked GitHub repository was containerized by OpenShift’s S2I function and deployed onto the OpenShift cluster.</p>
<p>Now that your application is running in a container in OpenShift, let’s see how an application developer can make a change to the source code, and then push the update to the running application.</p>
<p>We’ll make a simple change in a few lines of text to demonstrate. As we see in the Example Health application, there is a section with Personal Information.</p>
<p><img alt="personal-info" src="../images/personal-info.png" /></p>
</li>
<li>
<p><strong>In your forked GitHub repository, navigate to the source code again</strong>:</p>
</li>
<li>
<p><strong>Make sure you are in your own fork of the repository</strong>.</p>
</li>
<li>
<p>From <https://github.com/\<YOUR_GITHUB_USERNAME>/node-s2i-openshift>, <strong>click on the site folder</strong>.</p>
</li>
<li>
<p><strong>Click on the app.js file</strong>.</p>
</li>
<li>
<p>With the app.js file open, <strong>click on the edit button</strong> pointed out in the picture below.</p>
<p><img alt="gh-edit-button" src="../images/gh-edit-button.png" /></p>
</li>
<li>
<p><strong>Scroll down to line 55</strong>, which displays the patient name.</p>
</li>
<li>
<p><strong>Edit lines 55-60 as you wish, modifying the text strings for Name, Age, Gender, etc</strong>.</p>
<p><img alt="edited-gh" src="../images/edited-gh.png" /></p>
</li>
<li>
<p><strong>Click Commit Changes</strong> at the bottom of the page.</p>
</li>
</ol>
<p>You just edited the source code, but you still need to push the update to the running application.</p>
<ol>
<li>
<p><strong>Back in the OpenShift console, navigate to the Topology page -&gt; Click the Node.js application icon -&gt; Click the Resources tab -&gt; Click the Start Build button</strong>.</p>
<p><img alt="start-build" src="../images/start-build.png" /></p>
<p>A new Build #2 will be created. As with the first build, you can view the build logs to watch everything it’s doing, or you can simply wait for the console to display <code>Build #2 is complete</code> and your Pod <code>Running</code>.</p>
</li>
<li>
<p>When the Pod is <code>running</code>, <strong>refresh the Example Health browser tab</strong>.</p>
<p><img alt="patient-info-edited" src="../images/patient-info-edited.png" /></p>
</li>
</ol>
<p>Your code changes have been pushed to the running Example Health application.</p></section><section class="print-page" id="lab004-lab004-5"><h1 id="lab004-lab004-5-cleaning-up">Cleaning Up<a class="headerlink" href="#lab004-lab004-5-cleaning-up" title="Permanent link">&para;</a></h1>
<p>There is no easy way to delete all of these objects from the OpenShift console. This is a much easier task in the OpenShift command line.</p>
<ol>
<li>
<p>In the OpenShift CLI, <strong>make sure you are in your own project</strong> (i.e. userNN-project) <strong>and run the following command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc delete all --selector <span class="nv">app</span><span class="o">=</span>node-s-2-i-openshift -o name
</code></pre></div>
<details class="note" open="open"><summary>Note</summary><p>If you are not connected to the OpenShift command line, refer to Lab 002 – Using the OpenShift Command Line (<code>oc</code>).</p>
</details>
</li>
</ol>
<p>In this lab, you have exposed JavaScript source code in a GitHub repository to an OpenShift cluster, which containerized that JavaScript code into a container image, and then deployed it as a container running in a pod. You then made a code change to the JavaScript code and pushed an update to the application while it was running</p></section><h1 class='nav-section-title-end'>Ended: Lab 004 - Deploying an Application from Source Code</h1>
                        <h2 class='nav-section-title' id='section-lab-006-using-persistent-storage-with-mongodb-and-nodejs'>
                            Lab 006 - Using Persistent Storage with MongoDB and NodeJS <a class='headerlink' href='#section-lab-006-using-persistent-storage-with-mongodb-and-nodejs' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="lab006-lab006-1"><h1 id="lab006-lab006-1-lab-006-using-persistent-storage-mongodb-and-nodejs">Lab 006 - Using Persistent Storage - MongoDB and NodeJS<a class="headerlink" href="#lab006-lab006-1-lab-006-using-persistent-storage-mongodb-and-nodejs" title="Permanent link">&para;</a></h1>
<p>In production Kubernetes clusters, applications need to write data to storage where it will persist even if the application pods go down. In this lab, we’ll see how that’s done using Persistent Volumes and Persistent Volume Claims.</p>
<p>OpenShift on IBM Z supports various types of persistent storage, including Spectrum Scale, OpenShift Container Storage, and NFS, which is what this cluster uses. Before the start of the workshop, persistent volumes were defined in OpenShift, more than enough for one per user. Each persistent volume definition maps to the NFS server.</p>
<p><img alt="nfs-arch" src="../images/nfs-arch.png" /></p>
<p>In this lab, you will deploy an application consisting of two components, a containerized <em>Node.js web application</em> and a containerized <em>MongoDB</em> instance, which you will back with persistent storage. Using the Node.js web application, you will be able to query the database, as well as insert new data into it.</p>
<p><img alt="app-arch" src="../images/app-arch.png" /></p>
<p>To deploy the <em>Node.js application</em>, you will build and run the container from a Dockerfile residing in a GitHub repository.</p>
<p>To deploy <em>MongoDB</em>, you will pull a MongoDB image from <quay.io> and run it. The image in quay.io is the official MongoDB container image pulled from Docker Hub and moved to the Quay registry. This was done simply because Dockerhub has rate limits on pull requests from their public repository.</p></section><section class="print-page" id="lab006-lab006-2"><h1 id="lab006-lab006-2-connect-to-ocp-and-authenticate">Connect to OCP and Authenticate<a class="headerlink" href="#lab006-lab006-2-connect-to-ocp-and-authenticate" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p>In your virtual machine desktop, <strong>open a Firefox web browser</strong>.</p>
</li>
<li>
<p>In the browser, <strong>navigate to the OpenShift on IBM Z console</strong> at the following address: <a href="https://console-openshift-console.apps.atsocppa.dmz/">https://console-openshift-console.apps.atsocppa.dmz/</a>.</p>
<details class="note" open="open"><summary>Note</summary><p>You will receive a security challenge if the cluster has not yet been accessed from your browser. This is due to the default SSL certificate being “self-signed” and not yet recognized.</p>
<p>Accept the challenge to continue by <strong>clicking Advanced</strong> and then <strong>clicking Proceed to console-openshift-console.apps.atsocppa.dmz (unsafe)</strong>.</p>
<p>You will likely need to do this twice due to how OpenShift reroutes Oauth requests. </p>
</details>
<details><summary>Expand for screenshot</summary><p><img alt="security-accept.png" src="../images/security-accept.png" />
<img alt="security-accept-2.png" src="../images/security-accept-2.png" /></p>
</details>
<p>You will now see the OpenShift console login page.</p>
<p><img alt="openshift-console-login" src="../images/openshift-console-login.png" /></p>
</li>
<li>
<p>Log in with the OpenShift credentials provided to you on the <a href="#lab-assignments">Lab Assignments</a> page.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Your OpenShift credentials will be something like the following:</p>
<ul>
<li>
<p>Username: userNN (where NN is your user number)</p>
</li>
<li>
<p>Password: p@ssw0rd</p>
</li>
</ul>
</div>
</li>
</ol></section><section class="print-page" id="lab006-lab006-3"><h1 id="lab006-lab006-3-create-a-persistentvolumeclaim">Create a PersistentVolumeClaim<a class="headerlink" href="#lab006-lab006-3-create-a-persistentvolumeclaim" title="Permanent link">&para;</a></h1>
<p>As described in a previous section, a PersistentVolume has been already been predefined for each lab user. Next you will create a PersistentVolumeClaim that will bind to one of the available PersistentVolumes.</p>
<ol>
<li>
<p><strong>Change to the Administrator perspective</strong>, if not already there.</p>
</li>
<li>
<p><strong>Navigate to the Projects page</strong>. You can find it in the Menu, under Home -&gt; Projects.</p>
<p><img alt="home-projects" src="../images/home-projects.png" /></p>
</li>
<li>
<p><strong>Find and click on your userNN-project</strong>.</p>
</li>
<li>
<p>Under the menu button, <strong>click Storage -&gt; Persistent Volume Claims</strong>.</p>
</li>
<li>
<p><strong>Click “Create Persistent Volume Claim”</strong>.</p>
<p><img alt="create-pvc" src="../images/create-pvc.png" /></p>
<p>The Create Persistent Volume Claim form has four fields, and you’ll need to manually change each.</p>
<ul>
<li>
<p><strong>For Storage Class, select rootsquash-nfs</strong></p>
</li>
<li>
<p><strong>For Persistent Volume Claim Name, change the value to pvc-userNN</strong> (Replacing NN with your user #).</p>
</li>
<li>
<p><strong>For Access Mode, select Shared Access (RWX</strong>).</p>
</li>
<li>
<p><strong>For Size, change the value to 2 Gi</strong>.</p>
</li>
</ul>
<p>Your form should look like the following:</p>
<p><img alt="create-pvc-2" src="../images/create-pvc-2.png" /></p>
</li>
<li>
<p><strong>Click the create button</strong>.</p>
<p>You’ll be brought to the Overview for your newly created Persistent Volume Claim. The status of your claim should be <em>Bound</em>.</p>
<p><img alt="bound-pvc" src="../images/bound-pvc.png" /></p>
<details class="note" open="open"><summary>Note</summary><p>If your PersistentVolumeClaim does not bind almost immediately to a PersistentVolume, you likely did not fill out the fields as described above. You can delete your persistent volume claim and try again by clicking on the Actions dropdown and selecting Delete Persistent Volume Claim.</p>
</details>
</li>
</ol></section><section class="print-page" id="lab006-lab006-4"><h1 id="lab006-lab006-4-deploy-mongodb-from-a-container-image">Deploy MongoDB from a Container Image<a class="headerlink" href="#lab006-lab006-4-deploy-mongodb-from-a-container-image" title="Permanent link">&para;</a></h1>
<p>In this section, you will be deploying a container using a MongoDB container image from quay.io. A container image holds a set of software that is ready to run, while a container is a running instance of a container image. Images can be hosted in registries, such as the quay.io registry, Docker Hub, or a private registry of your own.</p>
<ol>
<li>
<p><strong>Toggle to the Developer Perspective and ensure you are in the correct userNN-project</strong>.</p>
<p><img alt="developer-userNN" src="../images/developer-userNN.png" /></p>
</li>
<li>
<p><strong>Click Add+ from the left-hand menu</strong>.</p>
</li>
<li>
<p><strong>Click the Container Image tile</strong>.</p>
<p>This brings up a new page which prompts you for an image name and further configurable parameters further down the page. Only the image name is required, and the rest will automatically populate for you.</p>
</li>
<li>
<p><strong>In the search bar for Image Name from external registry, type <code>quay.io/mmondics/mongo</code> and press enter</strong>.</p>
<p><img alt="mongo-search" src="../images/mongo-search.png" /></p>
<p>A green check mark and a “validated” message will appear in the search bar, indicating that the MongoDB image has been found and validated in Quay.</p>
<details class="important" open="open"><summary><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></summary><p>The fields below will automatically populate, but <strong><em>it is imperative that you change the Name field for your MongoDB service</em></strong>, or else the Node.js app will not be able to find and connect to the database.</p>
</details>
</li>
<li>
<p><strong>For Application Name, leave the default value</strong>.</p>
</li>
<li>
<p><strong><em>Replace the value of the Name field with mongodb</em></strong></p>
</li>
<li>
<p><strong>Leave Deployment and Create a Route to the Application checked</strong>.</p>
<p><img alt="mongo-fields" src="../images/mongo-fields.png" /></p>
</li>
<li>
<p><strong>Click the Create Button</strong>.</p>
<p>You will now be taken to the Topology view, where you will see an icon for your new MongoDB deployment.</p>
</li>
<li>
<p><strong>Click the icon for the mongodb deployment</strong>.</p>
<p>This will bring up a window on the right-hand side of the screen with information about your deployment.</p>
</li>
<li>
<p><strong>Select the Details tab</strong>, if not already selected.</p>
<p><img alt="mongo-details" src="../images/mongo-details.png" /></p>
<p>Depending on how quickly you clicked the icon, it will display either 1 pod, or 0 scaling to 1. If it has not scaled up to 1 pod yet, it will after a few seconds. However, we’re going to be adding and removing storage, so we will kill the pod once it comes up.</p>
</li>
<li>
<p><strong>Click the Down Arrow</strong> to reduce the pod count to zero.</p>
<p><img alt="mongo-down" src="../images/mongo-down.png" /></p>
<p>When a MongoDB pod is created, two storage volumes are attached to it. Let’s examine those.</p>
</li>
<li>
<p><strong>Click the mongodb deployment in the right-side window</strong>.</p>
<p><img alt="mongodb-deployment" src="../images/mongodb-deployment.png" /></p>
</li>
<li>
<p><strong>Once on the Deployment Details page, scroll down Volumes section</strong>.</p>
<p>Upon its creation, the pod created two volumes, mongodb-1 and mongodb-2. By default, MongoDB stores data in the <code>/data/db</code> directory, which is where the mongodb-2 volume has been mounted. This volume is not persistent. If the pod gets deleted, all of the stored data will be lost.</p>
<p>To make your MongoDB data persistent, you are going to delete mongodb-2 and instead mount your persistent volume claim at /data/db.</p>
</li>
<li>
<p><strong>Click the three dots for the mongodb-2 volume</strong>.</p>
</li>
<li>
<p><strong>Click Remove Volume</strong>.</p>
<p><img alt="remove-volume" src="../images/remove-volume.png" /></p>
<p>Now, you’ll add persistent storage, mounting the volume at /data/db.</p>
</li>
<li>
<p>Still on the Deployment Details page, <strong>scroll back up to the top and click the Actions dropdown</strong>.</p>
</li>
<li>
<p><strong>Click Add Storage</strong>.</p>
<p><img alt="add-storage" src="../images/add-storage.png" /></p>
<p>To add storage to your MongoDB deployment, you will need to fill out a couple of fields.</p>
</li>
<li>
<p><em>Use Existing Claim should already be selected</em>.</p>
</li>
<li>
<p><strong>From the Select Claim dropdown menu, select pvc-userNN</strong>.</p>
</li>
<li>
<p><strong>For Mount Path, enter <code>/data/db</code></strong>.</p>
</li>
<li>
<p><strong>For Subpath, enter your userNN</strong>, where NN is your user number.</p>
<p><img alt="add-storage-1" src="../images/add-storage-1.png" /></p>
<p><img alt="add-storage-2" src="../images/add-storage-2.png" /></p>
</li>
<li>
<p><strong>Click the Save button</strong>.</p>
<p>You will now be returned to the Deployment Details page. In the same way that you reduced the pod count to zero, you will now bring it back up to one.</p>
</li>
<li>
<p><strong>Click the Up Arrow to increase the pod count to one</strong>.</p>
<p><img alt="scale-mongo-up" src="../images/scale-mongo-up.png" /></p>
</li>
<li>
<p><strong>Scroll Down to the section labeled Volumes</strong>, and you’ll see the persistent volume now mounted at /data/db</p>
<p><img alt="mounted-pvc1" src="../images/mounted-pvc.png" /></p>
<p>Now you’re ready to deploy the Node.js web application.</p>
</li>
</ol></section><section class="print-page" id="lab006-lab006-5"><h1 id="lab006-lab006-5-deploy-nodejs-application-from-a-dockerfile">Deploy Node.js Application from a Dockerfile<a class="headerlink" href="#lab006-lab006-5-deploy-nodejs-application-from-a-dockerfile" title="Permanent link">&para;</a></h1>
<p>In this portion of the lab, you will deploy a Node.js web application created by the ATG. You will be building your deployment from a Dockerfile residing in a GitHub repository. Through the web application, you will be able to insert data into and query the MongoDB database you just created. For this lab the database will store sample name and email pairs displayed as a list of user information in the web UI.</p>
<p>First, you need to deploy the application.</p>
<ol>
<li>
<p>Staying in the Developer Perspective, <strong>click +Add from the left-side menu</strong>.</p>
</li>
<li>
<p><strong>Click the From Dockerfile tile</strong>.</p>
<p>Fill out the form as follows:</p>
</li>
<li>
<p><strong>In the Git Repo URL Field, enter</strong>:</p>
<div class="highlight"><pre><span></span><code>https://github.com/mmondics/mongodb-app
</code></pre></div>
<p>You should see a “Validated” message below the URL field.</p>
</li>
<li>
<p><strong>Ensure that the value in the Application field is mongo-app</strong>.</p>
</li>
<li>
<p><strong>Replace the value in the Name field with nodejs-app</strong>.</p>
</li>
<li>
<p><strong>Leave Deployment checked</strong>.</p>
<p><img alt="import-dockerfile" src="../images/import-dockerfile.png" /></p>
<p><img alt="import-dockerfile-2" src="../images/import-dockerfile-2.png" /></p>
</li>
<li>
<p><strong>Click the Create button</strong>.  </p>
<p>Your Node.js application will now pull the Dockerfile from GitHub and begin its build. You will be returned to the Topology view. You should see mongodb and nodejs-app grouped together in mongo-app. When the build is complete, you will see a blue ring form around nodejs-app. You can also check its status by clicking on the nodejs-app icon and examining the Details panel.</p>
</li>
<li>
<p>Once the build is complete, <strong>click the Open URL button at the top right of the nodejs-app icon</strong>.</p>
<p><img alt="open-url" src="../images/open-url.png" /></p>
<p>This button is simply a shortcut to the route that was created as part of the deployment.</p>
<p>You are brought to the following landing page for your Node.js application:</p>
<p><img alt="node-landing" src="../images/node-landing.png" /></p>
</li>
</ol>
<p>In the next section, you will insert data into and query your MongoDB database.</p></section><section class="print-page" id="lab006-lab006-6"><h1 id="lab006-lab006-6-interacting-with-mongodb-from-nodejs-web-application">Interacting with MongoDB from Node.js Web Application<a class="headerlink" href="#lab006-lab006-6-interacting-with-mongodb-from-nodejs-web-application" title="Permanent link">&para;</a></h1>
<p>You should be on the “Hello World” landing page of your Node.js web application. If you have moved off of this screen, refer to the previous section for instructions on how to access the application.</p>
<p>Since your application has not yet been used, the MongoDB database of user data will be empty. We can use the Node.js frontend application to insert data into the linked MongoDB pod and the persistent storage backing it.</p>
<ol>
<li>
<p><strong>Click the Add a New User button</strong>.</p>
<p><img alt="node-landing-2" src="../images/node-landing-2.png" /></p>
<p>You will be brought to a new page titled Add New User.</p>
</li>
<li>
<p><strong>Enter a sample username and email and click Submit</strong>.</p>
<p><img alt="add-new-user" src="../images/add-new-user.png" /></p>
<p>You will be brought to a page titled User List which displays the entire contents of your database. Feel free to add additional users.</p>
<p><img alt="user-list" src="../images/user-list.png" /></p>
<p>The data you just entered through the NodeJS web application is now stored in a MongoDB database backed by persistent storage on our NFS server. Now, let’s test that our data will persist if we simulate a database crash by deleting our MongoDB pod.</p>
</li>
<li>
<p><strong>Return to the OpenShift Console Developer Perspective and navigate to the Topology View</strong>.</p>
</li>
<li>
<p><strong>Click the mongodb deployment</strong>.</p>
</li>
<li>
<p><strong>Click the down arrow to reduce the pod count to zero, terminating the MongoDB pod</strong>.</p>
<p><img alt="mongo-down" src="../images/mongo-down.png" /></p>
</li>
<li>
<p><strong>Return to the web application and refresh the page</strong>.</p>
<p>The page will not connect, and if you wait long enough you will get a 504 Gateway Time-out error as the database no longer exists and no connection can be made.</p>
</li>
<li>
<p><strong>Back in OpenShift, click the up arrow to increase the pod count back to 1</strong>.</p>
</li>
<li>
<p><strong>Return to the web application and refresh the page again</strong>.</p>
<p>Your data still exists, even though the MongoDB pod was terminated and replaced by a completely new one.</p>
<p>In this section, a new MongoDB pod was created. Since you mounted NFS persistent storage at /data/db in the original MongoDB pod, your data persisted even when the original MongoDB pod was deleted and replaced with a new one. Without persistent storage, the new MongoDB pod would have contained an empty database.</p>
</li>
</ol></section><section class="print-page" id="lab006-lab006-7"><h1 id="lab006-lab006-7-cleaning-up">Cleaning Up<a class="headerlink" href="#lab006-lab006-7-cleaning-up" title="Permanent link">&para;</a></h1>
<p>There is no easy way to delete all of these objects from the OpenShift console. This is a much easier task in the OpenShift command line.</p>
<ol>
<li>
<p>In the OpenShift CLI, <strong>make sure you are in your own project</strong> (i.e. userNN-project) <strong>and run the following command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc delete all --selector <span class="nv">app</span><span class="o">=</span>node-s-2-i-openshift -o name
</code></pre></div>
<details class="note" open="open"><summary>Note</summary><p>If you are not connected to the OpenShift command line, refer to Lab 002 – Using the OpenShift Command Line (<code>oc</code>).</p>
</details>
</li>
</ol>
<p>This will delete most of the objects in your project, but not the Persistent Volume Claim you created.</p>
<ol>
<li>
<p><strong>To delete the PVC, run the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc delete pvc/pvc-userNN
</code></pre></div>
<p>Where <code>NN</code> is your user number.</p>
</li>
</ol></section><h1 class='nav-section-title-end'>Ended: Lab 006 - Using Persistent Storage with MongoDB and NodeJS</h1>
                        <h2 class='nav-section-title' id='section-lab-009-openshift-pipelines'>
                            Lab 009 - OpenShift Pipelines <a class='headerlink' href='#section-lab-009-openshift-pipelines' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="lab009-lab009-1"><h1 id="lab009-lab009-1-lab-009-using-openshift-pipelines">Lab 009 - Using OpenShift Pipelines<a class="headerlink" href="#lab009-lab009-1-lab-009-using-openshift-pipelines" title="Permanent link">&para;</a></h1>
<p>In this section, you will be connecting to a “Linux Guest” server which has a few things set up to make your life a little easier. Most notably, it has the OpenShift command line <code>oc</code> installed, so you don’t have to install it on your RHEL VM terminal.</p>
<ol>
<li>
<p><strong>Open a Terminal session</strong>.</p>
</li>
<li>
<p><strong>ssh into the Linux Guest server</strong>:</p>
<div class="highlight"><pre><span></span><code>ssh userNN@192.168.176.61
</code></pre></div>
<p>Where <code>NN</code> is your user number.</p>
</li>
<li>
<p>When prompted, <strong>enter your password: <code>p@ssw0rd</code> and hit enter</strong>.</p>
<details class="example" open="open"><summary>Example Output</summary><p><img alt="ascii-wsc.png" src="../images/ascii-wsc.png" /></p>
</details>
</li>
<li>
<p>In Firefox, <strong>navigate to the following URL</strong> to request an API token:</p>
<p><a href="https://oauth-openshift.apps.atsocppa.dmz/oauth/token/request">https://oauth-openshift.apps.atsocppa.dmz/oauth/token/request</a></p>
</li>
<li>
<p><strong>Enter your OpenShift credentials when prompted</strong>.</p>
<ul>
<li>
<p>Username: <code>userNN</code></p>
</li>
<li>
<p>Password: <code>p@ssw0rd</code></p>
</li>
</ul>
</li>
<li>
<p><strong>Click the “Display Token” hyperlink</strong>.</p>
<p><img alt="display-token.png" src="../images/display-token.png" /></p>
</li>
<li>
<p><strong>Copy the contents of the first text box</strong> beginning with “oc login” and ending with “6443”.</p>
<p><img alt="oc-login-token.png" src="../images/oc-login-token.png" /></p>
</li>
<li>
<p><strong>Paste this command back in your terminal session and press enter</strong>.</p>
<div class="highlight"><pre><span></span><code>oc login --token<span class="o">=</span>&lt;YOUR_TOKEN_HERE&gt; --server<span class="o">=</span>https://api.atsocppa.dmz:6443
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you’re prompted to use an insecure connection, type Y and hit enter.</p>
</div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~$ oc login --token<span class="o">=</span>uL3fHEPSGH3io0htdGRfAMAPIIY44BhwnGxCMA3dei4 --server<span class="o">=</span>https://api.atsocppa.dmz:6443
Logged into <span class="s2">&quot;https://api.atsocppa.dmz:6443&quot;</span> as <span class="s2">&quot;user01&quot;</span> using the token provided.

You have access to <span class="m">161</span> projects, the list has been suppressed. You can list all projects with <span class="s1">&#39;oc projects&#39;</span>

Using project <span class="s2">&quot;user01-project&quot;</span>.
</code></pre></div>
</details>
<p>You are now logged into the cluster via the command line, and you are told which project you are using.</p>
<p>If you’re in a project other than userNN-project, use the following command to move into it: <code>oc project userNN-project</code>, where NN is your user number.</p>
</li>
</ol></section><section class="print-page" id="lab009-lab009-2"><h1 id="lab009-lab009-2-cloning-the-github-repository-and-viewing-its-contents">Cloning the GitHub Repository and Viewing its Contents<a class="headerlink" href="#lab009-lab009-2-cloning-the-github-repository-and-viewing-its-contents" title="Permanent link">&para;</a></h1>
<p>In the terminal session, you should have been automatically placed in your home directory <code>/home/userNN</code> (where NN is your user number).</p>
<ol>
<li>
<p><strong>Run the command <code>pwd</code> to check your current working directory</strong>.</p>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~$ <span class="nb">pwd</span>
/home/user01
</code></pre></div>
</details>
</li>
<li>
<p>If you are in any other directory, <strong>change into the correct home directory using the command</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /home/userNN
</code></pre></div>
<p>Where <code>NN</code> is your user number).</p>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~$ <span class="nb">cd</span> /home/user01
user01@lab061:~$ <span class="nb">pwd</span>
/home/user01
</code></pre></div>
</details>
<ol>
<li>In your home directory, <strong>clone the OpenShift Pipelines repository using the command</strong>:</li>
</ol>
<div class="highlight"><pre><span></span><code>git clone https://github.com/mmondics/openshift-pipelines-s390x 
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~$ git clone https://github.com/mmondics/openshift-pipelines-s390x
Cloning into <span class="s1">&#39;openshift-pipelines-s390x&#39;</span>...
remote: Enumerating objects: <span class="m">25</span>, <span class="k">done</span>.
remote: Counting objects: <span class="m">100</span>% <span class="o">(</span><span class="m">25</span>/25<span class="o">)</span>, <span class="k">done</span>.
remote: Compressing objects: <span class="m">100</span>% <span class="o">(</span><span class="m">21</span>/21<span class="o">)</span>, <span class="k">done</span>.
remote: Total <span class="m">25</span> <span class="o">(</span>delta <span class="m">5</span><span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta <span class="m">0</span><span class="o">)</span>, pack-reused <span class="m">0</span>
Unpacking objects: <span class="m">100</span>% <span class="o">(</span><span class="m">25</span>/25<span class="o">)</span>, <span class="k">done</span>.
Checking connectivity... <span class="k">done</span>
</code></pre></div>
</details>
</li>
<li>
<p>This will create a new directory called <code>openliberty-pipelines-s390x</code>. <strong>Change into this directory using the command</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> openshift-pipelines-s390x
</code></pre></div>
</li>
<li>
<p><strong>List its contents using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>ls -l
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~$ <span class="nb">cd</span> openliberty-operator-ocpz
user01@lab061:~/openliberty-operator-ocpz$ ls -l
total <span class="m">16</span>
-rw-r--r-- <span class="m">1</span> user00 users   <span class="m">48</span> Mar <span class="m">16</span> <span class="m">14</span>:20 README.md
drwxr-xr-x <span class="m">2</span> user00 users <span class="m">4096</span> Mar <span class="m">16</span> <span class="m">14</span>:20 pipeline
-rw-r--r-- <span class="m">1</span> user00 users  <span class="m">251</span> Mar <span class="m">22</span> <span class="m">13</span>:23 pipeline-cleanup.sh
drwxr-xr-x <span class="m">2</span> user00 users <span class="m">4096</span> Mar <span class="m">16</span> <span class="m">14</span>:20 resources
drwxr-xr-x <span class="m">2</span> user00 users <span class="m">4096</span> Mar <span class="m">16</span> <span class="m">14</span>:20 tasks
</code></pre></div>
</details>
<p>If you navigate to the GitHub repository in a web browser <a href="https://github.com/mmondics/openshift-pipelines-s390x">https://github.com/mmondics/openshift-pipelines-s390x</a>, you will notice that the sub-directories in your Linux session reflect the folders contained in the repository.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>README.MD</code></td>
<td>Contains   the content displayed on the GitHub page for this repository. You can read through   this README file if you want to get more information about this lab.</td>
</tr>
<tr>
<td><code>pipeline</code></td>
<td>Directory   containing the YAML file that will be used to create a Pipeline.</td>
</tr>
<tr>
<td><code>pipeline-cleanup.sh</code></td>
<td>Shell   script that will delete all objects created in this lab.</td>
</tr>
<tr>
<td><code>resources</code></td>
<td>Directory   containing the YAML file that will create a PersistentVolumeClaim in   the cluster.</td>
</tr>
<tr>
<td><code>tasks</code></td>
<td>Directory   containing YAML files to create various Tasks that make up a pipeline.</td>
</tr>
</tbody>
</table>
</li>
</ol></section><section class="print-page" id="lab009-lab009-3"><h1 id="lab009-lab009-3-understanding-and-deploying-tasks">Understanding and Deploying Tasks<a class="headerlink" href="#lab009-lab009-3-understanding-and-deploying-tasks" title="Permanent link">&para;</a></h1>
<p>A <em>Task</em> defines a series of steps that run in a desired order and complete a set amount of build work. Every Task runs as a Pod on your OpenShift cluster with each step as its own container. Tasks have one single responsibility so they can be reused across different Pipelines or in multiple places within a single Pipeline.</p>
<p>The repository you pulled includes the YAML files needed to create three Tasks. Let’s take a look at one of them.</p>
<ol>
<li>
<p><strong>From the openshift-pipelines-s390x directory, run the command</strong>:</p>
<div class="highlight"><pre><span></span><code>cat tasks/hello.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ cat tasks/hello.yaml
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
name: hello
spec:
steps:
    - name: say-hello
    image: registry.access.redhat.com/ubi8/ubi
    command:
        - /bin/bash
    args: <span class="o">[</span><span class="s1">&#39;-c&#39;</span>, <span class="s1">&#39;echo Hello World&#39;</span><span class="o">]</span>
</code></pre></div>
</details>
<p>This file will create a Kubernetes Task object called hello that is made up of one step. That step has its own name, image, command, and args associated with it. As explained above, once created, this Task will create one Pod that includes one Container.</p>
</li>
<li>
<p><strong>Create the Task using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc create -f tasks/hello.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc create -f tasks/hello.yaml
task.tekton.dev/hello created
</code></pre></div>
</details>
<p>The Task is now created in your project and can be run using Tekton, the CI/CD tool that OpenShift Pipelines are based on.</p>
</li>
<li>
<p><strong>Run the <code>hello</code> task using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>tkn task start --showlog hello
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ tkn task start --showlog hello
TaskRun started: hello-run-xvr92
Waiting <span class="k">for</span> logs to be available...
<span class="o">[</span>say-hello<span class="o">]</span> Hello World
</code></pre></div>
</details>
<p>Running the <code>tkn task start</code> command created a new Kubernetes resource called a TaskRun. TaskRuns are automatically created for each Task that is run in a Pipeline, but as you can see, they can also be manually created by running a Task. This can be useful for debugging a single Task in a Pipeline.</p>
</li>
<li>
<p>Your Pipeline will consist of three Tasks total. <strong>Create the remaining Tasks using the commands</strong>:</p>
<div class="highlight"><pre><span></span><code>oc create -f tasks/apply_manifest_task.yaml
</code></pre></div>
<p>and</p>
<div class="highlight"><pre><span></span><code>oc create -f tasks/update_deployment_task.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc create -f tasks/apply_manifest_task.yaml
task.tekton.dev/apply-manifests created
user01@lab061:~/openshift-pipelines-s390x$ oc create -f tasks/update_deployment_task.yaml
task.tekton.dev/update-deployment created
</code></pre></div>
</details>
</li>
<li>
<p><strong>You have now created three Tasks that will be plumbed together to create a Pipeline. To see them, run the command</strong>:</p>
<div class="highlight"><pre><span></span><code>tkn task ls
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ tkn task ls
NAME                DESCRIPTION   AGE
apply-manifests                   <span class="m">7</span> minutes ago
hello                             <span class="m">8</span> minutes ago
update-deployment                 <span class="m">7</span> minutes ago
</code></pre></div>
</details>
<p>You will also need a <em>Workspace</em> in which your will run all of the Tasks associated with your Pipeline. This will be a shared space across each Task, TaskRun, Pipeline, and PipelineRun that you associate with the Workspace. With a Workspace, you can store Task inputs and outputs, share data among Tasks, use it as a mount point for credentials held in Secrets, create a cache of build artifacts that speed up jobs, and more.</p>
</li>
<li>
<p><strong>In our case, we will be using a PersistentVolumeClaim as our Workspace. Create the PVC using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc create -f resources/persistent_volume_claim.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc create -f resources/persistent_volume_claim.yaml
persistentvolumeclaim/source-pvc created
</code></pre></div>
</details>
</li>
</ol>
<p>In the next section, you will create a Pipeline that uses the Tasks and Workspace you just created to pull the source code of an application from GitHub and then builds and deploys it in a container on OpenShift.</p></section><section class="print-page" id="lab009-lab009-4"><h1 id="lab009-lab009-4-understanding-and-deploying-pipelines">Understanding and Deploying Pipelines<a class="headerlink" href="#lab009-lab009-4-understanding-and-deploying-pipelines" title="Permanent link">&para;</a></h1>
<p>A <em>Pipeline</em> consists of a series of Tasks that are executed to construct complex workflows that automate the build, deployment, and delivery of applications. It is a collection of PipelineResources, parameters, and one or more Tasks.</p>
<p>Below is a diagram of the Pipeline you will be creating.</p>
<p><img alt="pipeline-diagram" src="../images/pipeline-diagram.png" /></p>
<p>The repository you pulled provides the YAML file necessary to generate this Pipeline.</p>
<ol>
<li>
<p><strong>Take a look at the YAML by using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>cat pipeline/pipeline.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ cat tasks/hello.yaml
apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
name: build-and-deploy
spec:
workspaces:
- name: shared-workspace
params:
- name: deployment-name
    type: string
    description: name of the deployment to be patched
- name: git-url
    type: string
    description: url of the git repo <span class="k">for</span> the code of deployment
- name: git-revision
    type: string
    description: revision to be used from repo of the code <span class="k">for</span> deployment
    default: <span class="s2">&quot;master&quot;</span>
- name: IMAGE
    type: string
    description: image to be build from the code
tasks:
- name: fetch-repository
    taskRef:
    name: git-clone
    kind: ClusterTask
    workspaces:
    - name: output
    workspace: shared-workspace
    params:
    - name: url
    value: <span class="k">$(</span>params.git-url<span class="k">)</span>
    - name: subdirectory
    value: <span class="s2">&quot;&quot;</span>
    - name: deleteExisting
    value: <span class="s2">&quot;true&quot;</span>
    - name: revision
    value: <span class="k">$(</span>params.git-revision<span class="k">)</span>
- name: build-image
    taskRef:
    name: buildah
    kind: ClusterTask
    params:
    - name: TLSVERIFY
    value: <span class="s2">&quot;false&quot;</span>
    - name: IMAGE
    value: <span class="k">$(</span>params.IMAGE<span class="k">)</span>
    workspaces:
    - name: <span class="nb">source</span>
    workspace: shared-workspace
    runAfter:
    - fetch-repository
- name: apply-manifests
    taskRef:
    name: apply-manifests
    workspaces:
    - name: <span class="nb">source</span>
    workspace: shared-workspace
    runAfter:
    - build-image
- name: update-deployment
    taskRef:
    name: update-deployment
    params:
    - name: deployment
    value: <span class="k">$(</span>params.deployment-name<span class="k">)</span>
    - name: IMAGE
    value: <span class="k">$(</span>params.IMAGE<span class="k">)</span>
    runAfter:
    - apply-manifests
</code></pre></div>
</details>
<p>The Tasks included in this pipeline and their responsibilities are as follows:</p>
<ul>
<li>
<p><em>fetch-repository</em> clones the source code of the application from a GitHub repository based on the git-url and git-revision parameters.</p>
</li>
<li>
<p><em>build-image</em> builds the container image of the application using Buildah.</p>
</li>
<li>
<p><em>apply-manifests</em> deploys the application to OpenShift by running the oc apply command on the new container image with the provided parameters.</p>
</li>
<li>
<p><em>update-deployment</em> will update the application in OpenShift with the oc patch command when changes are needed.</p>
</li>
</ul>
<p>You will notice that there are no references to the GitHub repository or the image registry that will be pushed to in the pipeline. This is because Pipelines are designed to be generic and re-used in different situations or to deploy different applications. Pipelines abstract away the specific parameters that can be passed into the Pipeline. When triggering the Pipeline, you will provide different GitHub repositories and images to be used when executed.</p>
<p>Also notice that the execution order of Tasks can be determined by dependencies defined between Tasks via inputs and outputs, or explicitly ordered via runAfter.</p>
</li>
<li>
<p><strong>Create the Pipeline with the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc create -f pipeline/pipeline.yaml
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc create -f pipeline/pipeline.yaml
pipeline.tekton.dev/build-and-deploy created
</code></pre></div>
</details>
<p>Although we are using pre-built YAML files to simplify the creation of these resources, everything in this lab could also be done in the OpenShift console in a browser.</p>
</li>
<li>
<p><strong>Take a look at the graphical representation of your Pipeline by accessing the cluster at the URL: <a href="https://console-openshift-console.apps.atsocppa.dmz/">https://console-openshift-console.apps.atsocppa.dmz/</a></strong></p>
<p>Username: userNN (where NN is your user number)
Password: p@ssw0rd</p>
</li>
<li>
<p><strong>Navigate to the Developer Perspective -&gt; Pipelines -&gt; select your userNN Project</strong>.</p>
<p><img alt="dev-pipeline" src="../images/dev-pipeline.png" /></p>
</li>
<li>
<p><strong>Click your new Pipeline called <code>build-and-deploy</code></strong>.</p>
<p><img alt="build-and-deploy" src="../images/build-and-deploy.png" /></p>
<p>The framework of your Pipeline has been created, and you can see the four Tasks that make up your Pipeline.</p>
<div class="admonition information">
<p class="admonition-title">Information</p>
<p>If you remember making the apply-manifests and update-deployment Tasks, but not the “fetch-repository” and “build-image” Tasks -- you aren’t wrong. These are ClusterTasks that come pre-built into OpenShift.</p>
</div>
</li>
</ol>
<p>In the next section you will trigger a PipelineRun to execute your Pipeline and the Tasks it contains.</p></section><section class="print-page" id="lab009-lab009-5"><h1 id="lab009-lab009-5-running-the-pipeline">Running the Pipeline<a class="headerlink" href="#lab009-lab009-5-running-the-pipeline" title="Permanent link">&para;</a></h1>
<p>Let’s use this Pipeline to create an application. To demonstrate the re-usability of OpenShift Pipelines, we will be creating both a frontend and a backend with the same Pipeline you created in the previous step.</p>
<p>We’ll also demonstrate the flexibility provided by OpenShift Pipelines that lets you use them from either the web console or the command line.</p>
<p>Let’s create the backend application with the Tekton CLI in your terminal.</p>
<p>Now that you have all of the building blocks in place, you can start the Pipeline with the following command. The command will run the Pipeline and pass in parameters to:</p>
<ul>
<li>
<p>Use the shared workspace and the PersistentVolumeClaim you created</p>
</li>
<li>
<p>Create the deployment named vote-api</p>
</li>
<li>
<p>Build a container image from the source code at the given GitHub repository</p>
</li>
<li>
<p>Push that container image into the OpenShift internal registry and tag it for your project</p>
</li>
<li>
<p>Show the log so you can follow its progress
Note that the forward slash  simply breaks the command into multiple lines for readability.</p>
</li>
</ul>
<h2 id="lab009-lab009-5-creating-the-backend-application-through-the-cli">Creating the Backend Application through the CLI<a class="headerlink" href="#lab009-lab009-5-creating-the-backend-application-through-the-cli" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Run the following command</strong>:</p>
<div class="highlight"><pre><span></span><code>tkn pipeline start build-and-deploy <span class="se">\</span>
 -w <span class="nv">name</span><span class="o">=</span>shared-workspace,claimName<span class="o">=</span>source-pvc <span class="se">\</span>
 -p deployment-name<span class="o">=</span>vote-api <span class="se">\</span>
 -p git-url<span class="o">=</span>https://github.com/mmondics/pipelines-vote-api.git <span class="se">\</span>
 -p <span class="nv">IMAGE</span><span class="o">=</span>image-registry.openshift-image-registry.svc:5000/userNN-project/pipelines-vote-api --showlog 
</code></pre></div>
<div class="admonition important">
<p class="admonition-title"><img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /> Important <img alt="⚠" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/26a0.svg" title=":warning:" /></p>
<p>Make sure you change the one instance of <code>NN</code> to your team number in the command above.</p>
</div>
<details class="example"><summary>Expand for Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ tkn pipeline start build-and-deploy <span class="se">\</span>
&gt; -w <span class="nv">name</span><span class="o">=</span>shared-workspace,claimName<span class="o">=</span>source-pvc <span class="se">\</span>
&gt; -p deployment-name<span class="o">=</span>vote-api <span class="se">\</span>
&gt; -p git-url<span class="o">=</span>https://github.com/mmondics/vote-api.git <span class="se">\</span>
&gt; -p <span class="nv">IMAGE</span><span class="o">=</span>image-registry.openshift-image-registry.svc:5000/userNN-project/vote-api <span class="se">\</span>
&gt; --showlog
PipelineRun started: build-and-deploy-run-75zqv
Waiting <span class="k">for</span> logs to be available...
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nv">CHECKOUT_DIR</span><span class="o">=</span>/workspace/output/
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="o">[[</span> <span class="nb">true</span> <span class="o">==</span> <span class="se">\t\r\u\e</span> <span class="o">]]</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + cleandir
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="o">[[</span> -d /workspace/output/ <span class="o">]]</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + rm -rf /workspace/output//Dockerfile /workspace/output//LICENSE /workspace/output//README.md /workspace/output//go.mod /workspace/output//go.sum /workspace/output//k8s /workspace/output//main.go /workspace/output//vendor
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + rm -rf /workspace/output//.git /workspace/output//.gitignore
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + rm -rf <span class="s1">&#39;/workspace/output//..?*&#39;</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">test</span> -z <span class="s1">&#39;&#39;</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">test</span> -z <span class="s1">&#39;&#39;</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">test</span> -z <span class="s1">&#39;&#39;</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + /ko-app/git-init -url https://github.com/mmondics/vote-api.git -revision master -refspec <span class="s1">&#39;&#39;</span> -path /workspace/output/ -sslVerify<span class="o">=</span><span class="nb">true</span> -submodules<span class="o">=</span><span class="nb">true</span> -depth <span class="m">1</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> <span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="s2">&quot;info&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1616101272.5251348,<span class="s2">&quot;caller&quot;</span>:<span class="s2">&quot;git/git.go:165&quot;</span>,<span class="s2">&quot;msg&quot;</span>:<span class="s2">&quot;Successfully cloned https://github.com/mmondics/vote-api.git @ a08f579f6135293358b9423a3370e725ae1380cc (grafted, HEAD, origin/master) in path /workspace/output/&quot;</span><span class="o">}</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> <span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="s2">&quot;info&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1616101272.6701891,<span class="s2">&quot;caller&quot;</span>:<span class="s2">&quot;git/git.go:203&quot;</span>,<span class="s2">&quot;msg&quot;</span>:<span class="s2">&quot;Successfully initialized and updated submodules in path /workspace/output/&quot;</span><span class="o">}</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">cd</span> /workspace/output/
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> ++ git rev-parse HEAD
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nv">RESULT_SHA</span><span class="o">=</span>a08f579f6135293358b9423a3370e725ae1380cc
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nv">EXIT_CODE</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="s1">&#39;[&#39;</span> <span class="m">0</span> <span class="s1">&#39;!=&#39;</span> <span class="m">0</span> <span class="s1">&#39;]&#39;</span>
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">echo</span> -n a08f579f6135293358b9423a3370e725ae1380cc
<span class="o">[</span>fetch-respository : clone<span class="o">]</span> + <span class="nb">echo</span> -n https://github.com/mmondics/vote-api.git

<span class="o">[</span>build-image : build<span class="o">]</span> + buildah --storage-driver<span class="o">=</span>vfs bud --format<span class="o">=</span>oci --tls-verify<span class="o">=</span><span class="nb">false</span> --no-cache -f ./Dockerfile -t image-registry.openshift-image-registry.svc:5000/user00-project/vote-api .
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">1</span>: FROM image-registry.openshift-image-registry.svc:5000/openshift/golang:latest AS builder
<span class="o">[</span>build-image : build<span class="o">]</span> Getting image <span class="nb">source</span> signatures
<span class="o">[</span>build-image : build<span class="o">]</span> Copying blob sha256:ff637d5a66cba4903fc7d9343b0f9dbb4e1bf8ada19bd3934ea0edfb85dc4
<span class="o">[</span>build-image : build<span class="o">]</span> Copying blob sha256:f7fb0662b957bcb1b5007f9b5502af4da4c13e17b7bc2eff4f02c3e5ec08e
<span class="o">[</span>build-image : build<span class="o">]</span> Copying blob sha256:35aab756d1a095511ab75eeca5aa77a37fa62a258f3fa5bcfb37ad604e369
<span class="o">[</span>build-image : build<span class="o">]</span> Copying blob sha256:7cc70ce0e0ee7fe5f8ea22894ad8c2f962f1dfdd00d05de91a32181c89179
<span class="o">[</span>build-image : build<span class="o">]</span> Copying blob sha256:73986f838dc404255946f6aa282b0aeabc420faa4f21b572e1de735498edf
<span class="o">[</span>build-image : build<span class="o">]</span> Copying config sha256:9e8f033b036bdb224dc931cfcaaf532da6a6ae7d779e8a09c52eed12305
<span class="o">[</span>build-image : build<span class="o">]</span> Writing manifest to image destination
<span class="o">[</span>build-image : build<span class="o">]</span> Storing signatures
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">2</span>: WORKDIR /build
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">3</span>: ADD . /build/
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">4</span>: RUN <span class="nb">export</span> <span class="nv">GARCH</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>uname -m<span class="k">)</span><span class="s2">&quot;</span> <span class="o">&amp;&amp;</span> <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">GARCH</span><span class="si">}</span> <span class="o">==</span> <span class="s2">&quot;s390x&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">export</span> <span class="nv">GARCH</span><span class="o">=</span><span class="s2">&quot;s390x&quot;</span><span class="p">;</span> <span class="k">fi</span> <span class="o">&amp;&amp;</span> <span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span><span class="si">${</span><span class="nv">GARCH</span><span class="si">}</span> <span class="nv">CGO_ENABLED</span><span class="o">=</span><span class="m">0</span> go build -mod<span class="o">=</span>vendor -o api-server 
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">5</span>: FROM scratch
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">6</span>: WORKDIR /app
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">7</span>: COPY --from<span class="o">=</span>builder /build/api-server /app/api-server
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">8</span>: CMD <span class="o">[</span> <span class="s2">&quot;/app/api-server&quot;</span> <span class="o">]</span>
<span class="o">[</span>build-image : build<span class="o">]</span> STEP <span class="m">9</span>: COMMIT image-registry.openshift-image-registry.svc:5000/user00-project/vote-api
<span class="o">[</span>build-image : build<span class="o">]</span> --&gt; 36faca61f94
<span class="o">[</span>build-image : build<span class="o">]</span> 36faca61f941af886128abd8792753095eaac7c1041084e222f426243ed50ecc

<span class="o">[</span>build-image : push<span class="o">]</span> + buildah --storage-driver<span class="o">=</span>vfs push --tls-verify<span class="o">=</span><span class="nb">false</span> --digestfile /workspace/source/image-digest image-registry.openshift-image-registry.svc:5000/user00-project/vote-api docker://image-registry.openshift-image-registry.svc:5000/user00-project/vote-api
<span class="o">[</span>build-image : push<span class="o">]</span> + buildah --storage-driver<span class="o">=</span>vfs push --tls-verify<span class="o">=</span><span class="nb">false</span> --digestfile /workspace/source/image-digest image-registry.openshift-image-registry.svc:5000/user00-project/vote-api docker://image-registry.openshift-image-registry.svc:5000/user00-project/vote-api
<span class="o">[</span>build-image : push<span class="o">]</span> Getting image <span class="nb">source</span> signatures
<span class="o">[</span>build-image : push<span class="o">]</span> Copying blob sha256:9eda1116f7414b98e397f94cc650fd50890c2d97fa47925e02b83df7726119
<span class="o">[</span>build-image : push<span class="o">]</span> Copying config sha256:36faca61f941af886128abd8792753095eaac7c1041084e222f426243ed5
<span class="o">[</span>build-image : push<span class="o">]</span> Writing manifest to image destination
<span class="o">[</span>build-image : push<span class="o">]</span> Storing signatures

<span class="o">[</span>build-image : digest-to-results<span class="o">]</span> + cat /workspace/source/image-digest
<span class="o">[</span>build-image : digest-to-results<span class="o">]</span> + tee /tekton/results/IMAGE_DIGEST
<span class="o">[</span>build-image : digest-to-results<span class="o">]</span> sha256:a7d730f92530c2f10891c55ba86a44e4fcc907436831c99733779ffb0d0fe8

<span class="o">[</span>apply-manifests : apply<span class="o">]</span> Applying manifests <span class="k">in</span> k8s directory
<span class="o">[</span>apply-manifests : apply<span class="o">]</span> deployment.apps <span class="s2">&quot;vote-api&quot;</span> created
<span class="o">[</span>apply-manifests : apply<span class="o">]</span> service <span class="s2">&quot;vote-api&quot;</span> created
<span class="o">[</span>apply-manifests : apply<span class="o">]</span> -----------------------------------

<span class="o">[</span>update-deployment : patch<span class="o">]</span> deployment.apps <span class="s2">&quot;vote-api&quot;</span> patched
</code></pre></div>
</details>
<p>If you see the final <code>deployment.apps “vote-api” patched</code> line, your PipelineRun was successful and your backend application is now deployed in OpenShift.</p>
</li>
<li>
<p><strong>Look at your running application Pod by issuing the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc get pod
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc get pod
NAME                                                           READY   STATUS      RESTARTS   AGE
build-and-deploy-run-sgtc7-apply-manifests-9p6mv-pod-95jhw     <span class="m">0</span>/1     Completed   <span class="m">0</span>          9m52s
build-and-deploy-run-sgtc7-build-image-6kh6n-pod-pkvgx         <span class="m">0</span>/3     Completed   <span class="m">0</span>          12m
build-and-deploy-run-sgtc7-fetch-repository-flxfx-pod-p6nzh    <span class="m">0</span>/1     Completed   <span class="m">0</span>          13m
build-and-deploy-run-sgtc7-update-deployment-hgxrz-pod-htqpf   <span class="m">0</span>/1     Completed   <span class="m">0</span>          9m33s
vote-api-6765569bfb-v4jlh                                      <span class="m">1</span>/1     Running     <span class="m">0</span>          9m20s
</code></pre></div>
</details>
<p>You should see one <em>running</em> Pod and four <em>completed</em> Pods. The running Pod is your application that the Pipeline pulled from GitHub, containerized, pushed into the internal OpenShift repository, and started. The completed Pods were created to complete the Tasks defined in the Pipeline, and each is made up of one container per step in the Task.</p>
<p>Looking at the READY column, you can see that most of the Pods have one container, with the exception of the build-image Pod that has three.</p>
</li>
<li>
<p><strong>The Tekton CLI also provides a way to check your Pipelines and PipelineRuns by running</strong>:</p>
<div class="highlight"><pre><span></span><code>tkn pipeline ls
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ tkn pipeline ls
NAME               AGE             LAST RUN                     STARTED         DURATION    STATUS
build-and-deploy   <span class="m">4</span> minutes ago   build-and-deploy-run-2q5fp   <span class="m">4</span> minutes ago   <span class="m">3</span> minutes   Succeeded
</code></pre></div>
</details>
</li>
</ol>
<p>Since we have successfully run the Pipeline in the CLI, let’s trigger a run from the console in the next section.</p>
<h2 id="lab009-lab009-5-creating-the-frontend-application-through-the-console">Creating the Frontend Application through the Console<a class="headerlink" href="#lab009-lab009-5-creating-the-frontend-application-through-the-console" title="Permanent link">&para;</a></h2>
<p>Let’s create the frontend portion of our application by running the Pipeline from the OpenShift console.</p>
<ol>
<li>
<p><strong>If you’ve closed out of the OpenShift console in your web browser, go back to <a href="https://console-openshift-console.apps.atsocppa.dmz/">https://console-openshift-console.apps.atsocppa.dmz/</a></strong></p>
</li>
<li>
<p><strong>Navigate to the Developer Perspective -&gt; Pipelines -&gt; and select your userNN Project</strong>.</p>
<p><img alt="build-and-deploy-2" src="../images/build-and-deploy-2.png" /></p>
<p>The main Pipelines page displays the same information returned from the <code>tkn pipeline ls</code> command.</p>
</li>
<li>
<p><strong>Click your build-and-deploy Pipeline and then click the Actions -&gt; Start button</strong>.</p>
<p><img alt="start-pipeline" src="../images/start-pipeline.png" /></p>
<p>This will open a new window that prompts you for the parameters with which to start your second PipelineRun. This window is the GUI equivalent to the multi-line <code>tkn pipeline start</code> command that we entered in the CLI PipelineRun.</p>
</li>
<li>
<p><strong>Enter the following parameters</strong>:</p>
<ul>
<li>deployment name: <code>vote-ui</code></li>
<li>git-url: <code>https://github.com/mmondics/pipelines-vote-ui.git</code></li>
<li>git-revision: <code>master</code></li>
<li>IMAGE: <code>image-registry.openshift-image-registry.svc:5000/userNN-project/vote-ui</code></li>
<li>shared-workspace: <code>PVC</code> -&gt; <code>source-pvc</code></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure you change the one instance of <code>NN</code> in the IMAGE field to your user number.</p>
</div>
</li>
<li>
<p><strong>Then click start</strong>.</p>
<p><img alt="start-pipeline-ui" src="../images/start-pipeline-ui.png" /></p>
<p>You will be taken to the page for your PipelineRun and shown the graphical representation of the running Pipeline.</p>
<p><img alt="pipeline-running" src="../images/pipeline-running.png" /></p>
</li>
<li>
<p><strong>Click the logs tab</strong> to follow what’s happening in more detail like you saw in the CLI.</p>
<p><img alt="pipeline-logs" src="../images/pipeline-running.png" /></p>
</li>
</ol>
<p>When you see the PipelineRun has Succeeded and the <code>deployment.apps “vote-ui” has been patched</code>, your frontend application is also up and running.</p>
<p>With both your backend and frontend applications are running, in the next section we’ll access it in a browser.</p></section><section class="print-page" id="lab009-lab009-6"><h1 id="lab009-lab009-6-accessing-the-pipeline-in-a-browser">Accessing the Pipeline in a Browser<a class="headerlink" href="#lab009-lab009-6-accessing-the-pipeline-in-a-browser" title="Permanent link">&para;</a></h1>
<p>Your application is accessible via its route.</p>
<ol>
<li>
<p>In the OpenShift console, <strong>navigate to the Topology page in the Developer Perspective and make sure you’re in your userNN-project</strong>.</p>
<p><img alt="pipeline-app-topology" src="../images/pipeline-app-topology.png" /></p>
<p>You should see two Icons with solid blue bars indicating your application pods are running without error.</p>
</li>
<li>
<p>On the vote-ui icon, <strong>click the button in the top right corner to navigate to the application’s exposed route</strong>.</p>
<p><img alt="pipeline-app-topology-2" src="../images/pipeline-app-topology-2.png" /></p>
<p>This will open a new browser tab for your frontend application UI.</p>
<p><img alt="cat-dog" src="../images/cat-dog.png" /></p>
</li>
<li>
<p><strong>Click the box for your desired option</strong>.</p>
<p>By casting your vote with the vote-ui frontend, you are invoking a REST API call and sending a POST request that is stored in the vote-api backend application.</p>
<p>You can see this POST request reflected in the vote-api Pod logs.</p>
</li>
<li>
<p><strong>In your terminal session find the name of your vote-api Pod using the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc get pods <span class="p">|</span> grep Running
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc get pods <span class="p">|</span> grep Running
vote-api-6765569bfb-p2bhh                                      <span class="m">1</span>/1     Running     <span class="m">0</span>          65m
vote-ui-6846f88f6f-rzzgt                                       <span class="m">1</span>/1     Running     <span class="m">0</span>          18m
</code></pre></div>
</details>
</li>
<li>
<p><strong>Copy the full name for your vote-api Pod and view its logs with the command</strong>:</p>
<div class="highlight"><pre><span></span><code>oc logs pod/vote-api-XXXXXXXXXX-YYYYY 
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Your randomly-generated Pod names will differ.</p>
</div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc logs pod/vote-api-6765569bfb-p2bhh
<span class="o">[</span>GIN-debug<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> Creating an Engine instance with the Logger and Recovery middleware already attached.

<span class="o">[</span>GIN-debug<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> Running <span class="k">in</span> <span class="s2">&quot;debug&quot;</span> mode. Switch to <span class="s2">&quot;release&quot;</span> mode <span class="k">in</span> production.
- using env:    <span class="nb">export</span> <span class="nv">GIN_MODE</span><span class="o">=</span>release
- using code:   gin.SetMode<span class="o">(</span>gin.ReleaseMode<span class="o">)</span>

<span class="o">[</span>GIN-debug<span class="o">]</span> GET    /vote                     --&gt; main.setupRouter.func1 <span class="o">(</span><span class="m">3</span> handlers<span class="o">)</span>
<span class="o">[</span>GIN-debug<span class="o">]</span> POST   /vote                     --&gt; main.setupRouter.func2 <span class="o">(</span><span class="m">3</span> handlers<span class="o">)</span>
<span class="o">[</span>GIN-debug<span class="o">]</span> Listening and serving HTTP on :9000
<span class="o">[</span>GIN<span class="o">]</span> <span class="m">2021</span>/03/22 - <span class="m">16</span>:18:18 <span class="p">|</span> <span class="m">200</span> <span class="p">|</span>     <span class="m">179</span>.658µs <span class="p">|</span>    <span class="m">10</span>.131.1.157 <span class="p">|</span> POST     /vote
<span class="o">[</span>GIN<span class="o">]</span> <span class="m">2021</span>/03/22 - <span class="m">16</span>:18:48 <span class="p">|</span> <span class="m">200</span> <span class="p">|</span>     <span class="m">107</span>.379µs <span class="p">|</span>    <span class="m">10</span>.131.1.157 <span class="p">|</span> POST     /vote
</code></pre></div>
</details>
<p>You can see your POST requests at the <code>/vote</code> endpoint at the bottom, and more detail is stored in NFS by the PersistentVolumeClaim you created earlier.</p>
</li>
</ol>
<p>In this lab, you have:</p>
<ul>
<li>Created Tasks that have specific responsibilities in the building and deploying of a containerized application onto an OpenShift on IBM Z cluster</li>
<li>Created a Pipeline that combines these Tasks to one end-to-end process</li>
<li>Ran the Pipeline twice -- once from the command line, and once from the OpenShift console -- to create a backend and a frontend application.</li>
<li>Used the created applications to invoke a REST API call that is stored persistently in NFS storage.</li>
</ul></section><section class="print-page" id="lab009-lab009-7"><h1 id="lab009-lab009-7-cleaning-up">Cleaning Up<a class="headerlink" href="#lab009-lab009-7-cleaning-up" title="Permanent link">&para;</a></h1>
<ol>
<li>
<p>When you’re ready to finish the lab and delete the objects you created, <strong>return to your terminal and double check that you’re in your own userNN-project with</strong>:</p>
<div class="highlight"><pre><span></span><code>oc project
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ oc project
Using project <span class="s2">&quot;user00-project&quot;</span> on server <span class="s2">&quot;https://api.atsocpd2.dmz:6443&quot;</span>.
</code></pre></div>
</details>
</li>
<li>
<p><strong>Run the uninstall script</strong>:</p>
<div class="highlight"><pre><span></span><code>./pipeline-cleanup.sh
</code></pre></div>
<details class="example" open="open"><summary>Example Output</summary><div class="highlight"><pre><span></span><code>user01@lab061:~/openshift-pipelines-s390x$ ./pipeline-cleanup.sh
Running oc delete all --all
pod <span class="s2">&quot;build-and-deploy-run-6hgg7-apply-manifests-ksns5-pod-zvnq8&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-6hgg7-build-image-4bstq-pod-sd2xv&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-6hgg7-fetch-repository-jgqml-pod-ld4nj&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-6hgg7-update-deployment-qhmxh-pod-c56gj&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-fnx5s-apply-manifests-k8v7f-pod-88fpm&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-fnx5s-build-image-4xknh-pod-kq4zk&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-fnx5s-fetch-repository-m5pmr-pod-8m5gt&quot;</span> deleted
pod <span class="s2">&quot;build-and-deploy-run-fnx5s-update-deployment-fgq9s-pod-2s4vw&quot;</span> deleted
pod <span class="s2">&quot;hello-run-l2skb-pod-vzvrj&quot;</span> deleted
pod <span class="s2">&quot;vote-api-6765569bfb-p59vj&quot;</span> deleted
pod <span class="s2">&quot;vote-ui-6846f88f6f-z7zp9&quot;</span> deleted
service <span class="s2">&quot;vote-api&quot;</span> deleted
service <span class="s2">&quot;vote-ui&quot;</span> deleted
deployment.apps <span class="s2">&quot;vote-api&quot;</span> deleted
deployment.apps <span class="s2">&quot;vote-ui&quot;</span> deleted
replicaset.apps <span class="s2">&quot;vote-ui-566848fff4&quot;</span> deleted
replicaset.apps <span class="s2">&quot;vote-ui-6846f88f6f&quot;</span> deleted
imagestream.image.openshift.io <span class="s2">&quot;vote-api&quot;</span> deleted
imagestream.image.openshift.io <span class="s2">&quot;vote-ui&quot;</span> deleted
route.route.openshift.io <span class="s2">&quot;vote-ui&quot;</span> deleted
Deleting Pipeline <span class="p">&amp;</span> resources
pipeline.tekton.dev <span class="s2">&quot;build-and-deploy&quot;</span> deleted
pipelinerun.tekton.dev <span class="s2">&quot;build-and-deploy-run-6hgg7&quot;</span> deleted
pipelinerun.tekton.dev <span class="s2">&quot;build-and-deploy-run-fnx5s&quot;</span> deleted
task.tekton.dev <span class="s2">&quot;apply-manifests&quot;</span> deleted
task.tekton.dev <span class="s2">&quot;hello&quot;</span> deleted
task.tekton.dev <span class="s2">&quot;update-deployment&quot;</span> deleted
taskrun.tekton.dev <span class="s2">&quot;hello-run-l2skb&quot;</span> deleted
Deleting PVC
persistentvolumeclaim <span class="s2">&quot;source-pvc&quot;</span> deleted
Removing Images
</code></pre></div>
</details>
</li>
</ol></section><h1 class='nav-section-title-end'>Ended: Lab 009 - OpenShift Pipelines</h1><h1 class='nav-section-title-end'>Ended: Labs</h1></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>